import{x as d,bp as x,y as g,au as p,l as i,d8 as D,d9 as b,v as f,t as u}from"./index-CHozcNii.js";const l=`Ethereum Signed Message:
`;function P(n){const t=typeof n=="string"?d(n):typeof n.raw=="string"?n.raw:x(n.raw),e=d(`${l}${g(t)}`);return p([e,t])}function H(n,t){return i(P(n),t)}function M(n){const{domain:t={},message:e,primaryType:r}=n,o={EIP712Domain:D({domain:t}),...n.types};b({domain:t,message:e,primaryType:r,types:o});const a=["0x1901"];return t&&a.push($({domain:t,types:o})),r!=="EIP712Domain"&&a.push(y({data:e,primaryType:r,types:o})),i(p(a))}function $({domain:n,types:t}){return y({data:n,primaryType:"EIP712Domain",types:t})}function y({data:n,primaryType:t,types:e}){const r=h({data:n,primaryType:t,types:e});return i(r)}function h({data:n,primaryType:t,types:e}){const r=[{type:"bytes32"}],o=[I({primaryType:t,types:e})];for(const a of e[t]){const[s,c]=T({types:e,name:a.name,type:a.type,value:n[a.name]});r.push(s),o.push(c)}return f(r,o)}function I({primaryType:n,types:t}){const e=u(w({primaryType:n,types:t}));return i(e)}function w({primaryType:n,types:t}){let e="";const r=m({primaryType:n,types:t});r.delete(n);const o=[n,...Array.from(r).sort()];for(const a of o)e+=`${a}(${t[a].map(({name:s,type:c})=>`${c} ${s}`).join(",")})`;return e}function m({primaryType:n,types:t},e=new Set){const o=n.match(/^\w*/u)?.[0];if(e.has(o)||t[o]===void 0)return e;e.add(o);for(const a of t[o])m({primaryType:a.type,types:t},e);return e}function T({types:n,name:t,type:e,value:r}){if(n[e]!==void 0)return[{type:"bytes32"},i(h({data:r,primaryType:e,types:n}))];if(e==="bytes")return r=`0x${(r.length%2?"0":"")+r.slice(2)}`,[{type:"bytes32"},i(r)];if(e==="string")return[{type:"bytes32"},i(u(r))];if(e.lastIndexOf("]")===e.length-1){const o=e.slice(0,e.lastIndexOf("[")),a=r.map(s=>T({name:t,type:o,types:n,value:s}));return[{type:"bytes32"},i(f(a.map(([s])=>s),a.map(([,s])=>s)))]}return[{type:e},r]}export{M as a,H as h};
