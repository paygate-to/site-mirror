import{d as Bn,f as $r,h as Kr,N as Fr,i as ut,j as en,F as tn,k as Br,l as dt,m as F,n as Yr,o as Hr,p as Mt,I as Qr,q as Wr,r as Gr,e as xt,s as nn,t as Yn,u as Rt,w as pn,x as hn,y as Vr,A as rn,B as vt,C as Zr,D as Jr,E as ot,G as Hn,H as N,J as Qn,K as Wn,L as Xr,z as _e,M as es,v as ts,a as ns,O as rs,P as ss,Q as as,g as os,R as is,S as cs}from"./verifyHash-DWRIP4zj.js";import{be as Ze,j as V,X as Z,bf as kt,bg as Et,bh as Gn,B as de,bi as us,y as ds,I as ls,s as fs,bj as ps,bk as hs,bl as ys,bm as ms,bn as gs,n as P,W as xe,bo as ie,bp as bs,bq as ws,br as Is,bs as Ms,bt as xs,bu as vs,q as be,t as W,bv as ks,bw as Vn,bx as Zn,m as re,by as Jn,h as $,bz as Es,bA as sn,bB as Ue,b2 as js,b3 as Ds,b4 as As,bC as qe,bD as Xn,aB as jt,bE as X,bF as we,E as Ts,bG as J,bH as lt,bI as q,bJ as Ps,bK as an,bL as zs,aY as Cs,a7 as Os,bM as O,bN as yn,bO as R,bP as er,bQ as Dt,bR as Ns,bS as Ss,bT as mn,bU as Ne,bV as gn,bW as _s,bX as bn,bY as wn,bZ as In,b_ as Mn,b$ as xn,c0 as vn,c1 as Us,c2 as qs,c3 as Rs,i as At,aT as tr,c4 as Ls,c5 as $s,c6 as Ks,c7 as Fs,c8 as Bs,c9 as Ys,ca as Hs,cb as Qs,cc as Ws,cd as Gs,ce as Vs,cf as on,cg as Zs,ch as nr,ci as rr,cj as Js,ck as Xs,cl as ea,cm as ta,cn as na,co as ra,cp as sa,cq as aa,cr as cn,cs as oa,ct as ia,cu as ft,cv as pt,cw as ca,cx as ua,cy as da,cz as la,cA as fa,cB as pa,cC as ha,w as Ce,cD as ya,cE as ma,cF as ga,cG as ba}from"./index-CHozcNii.js";import{a as wa,h as Ia}from"./hashTypedData-yjrV4hv1.js";import{c as Ma,s as xa,d as va,g as ka}from"./index-nibyPLVP.js";import"./isAddressEqual-DT7yxKk4.js";function Ea(e){const{authorizationList:t}=e;if(t)for(const n of t){const{chainId:r}=n,s=n.address;if(!V(s))throw new Z({address:s});if(r<0)throw new Ze({chainId:r})}un(e)}function ja(e){const{blobVersionedHashes:t}=e;if(t){if(t.length===0)throw new us;for(const n of t){const r=ds(n),s=ls(fs(n,0,1));if(r!==32)throw new ps({hash:n,size:r});if(s!==hs)throw new ys({hash:n,version:s})}}un(e)}function un(e){const{chainId:t,maxPriorityFeePerGas:n,maxFeePerGas:r,to:s}=e;if(t<=0)throw new Ze({chainId:t});if(s&&!V(s))throw new Z({address:s});if(r&&r>kt)throw new Et({maxFeePerGas:r});if(n&&r&&n>r)throw new Gn({maxFeePerGas:r,maxPriorityFeePerGas:n})}function Da(e){const{chainId:t,maxPriorityFeePerGas:n,gasPrice:r,maxFeePerGas:s,to:o}=e;if(t<=0)throw new Ze({chainId:t});if(o&&!V(o))throw new Z({address:o});if(n||s)throw new de("`maxFeePerGas`/`maxPriorityFeePerGas` is not a valid EIP-2930 Transaction attribute.");if(r&&r>kt)throw new Et({maxFeePerGas:r})}function Aa(e){const{chainId:t,maxPriorityFeePerGas:n,gasPrice:r,maxFeePerGas:s,to:o}=e;if(o&&!V(o))throw new Z({address:o});if(typeof t<"u"&&t<=0)throw new Ze({chainId:t});if(n||s)throw new de("`maxFeePerGas`/`maxPriorityFeePerGas` is not a valid Legacy Transaction attribute.");if(r&&r>kt)throw new Et({maxFeePerGas:r})}function Je(e){if(!e||e.length===0)return[];const t=[];for(let n=0;n<e.length;n++){const{address:r,storageKeys:s}=e[n];for(let o=0;o<s.length;o++)if(s[o].length-2!==64)throw new ms({storageKey:s[o]});if(!V(r,{strict:!1}))throw new Z({address:r});t.push([r,s])}return t}function Ta(e,t){const n=gs(e);return n==="eip1559"?Ca(e,t):n==="eip2930"?Oa(e,t):n==="eip4844"?za(e,t):n==="eip7702"?Pa(e,t):Na(e,t)}function Pa(e,t){const{authorizationList:n,chainId:r,gas:s,nonce:o,to:i,value:u,maxFeePerGas:c,maxPriorityFeePerGas:a,accessList:f,data:p}=e;Ea(e);const d=Je(f),l=Sa(n);return xe(["0x04",ie([P(r),o?P(o):"0x",a?P(a):"0x",c?P(c):"0x",s?P(s):"0x",i??"0x",u?P(u):"0x",p??"0x",d,l,...ve(e,t)])])}function za(e,t){const{chainId:n,gas:r,nonce:s,to:o,value:i,maxFeePerBlobGas:u,maxFeePerGas:c,maxPriorityFeePerGas:a,accessList:f,data:p}=e;ja(e);let d=e.blobVersionedHashes,l=e.sidecars;if(e.blobs&&(typeof d>"u"||typeof l>"u")){const w=typeof e.blobs[0]=="string"?e.blobs:e.blobs.map(x=>bs(x)),I=e.kzg,M=ws({blobs:w,kzg:I});if(typeof d>"u"&&(d=Is({commitments:M})),typeof l>"u"){const x=Ms({blobs:w,commitments:M,kzg:I});l=xs({blobs:w,commitments:M,proofs:x})}}const h=Je(f),y=[P(n),s?P(s):"0x",a?P(a):"0x",c?P(c):"0x",r?P(r):"0x",o??"0x",i?P(i):"0x",p??"0x",h,u?P(u):"0x",d??[],...ve(e,t)],m=[],g=[],b=[];if(l)for(let w=0;w<l.length;w++){const{blob:I,commitment:M,proof:x}=l[w];m.push(I),g.push(M),b.push(x)}return xe(["0x03",l?ie([y,m,g,b]):ie(y)])}function Ca(e,t){const{chainId:n,gas:r,nonce:s,to:o,value:i,maxFeePerGas:u,maxPriorityFeePerGas:c,accessList:a,data:f}=e;un(e);const p=Je(a),d=[P(n),s?P(s):"0x",c?P(c):"0x",u?P(u):"0x",r?P(r):"0x",o??"0x",i?P(i):"0x",f??"0x",p,...ve(e,t)];return xe(["0x02",ie(d)])}function Oa(e,t){const{chainId:n,gas:r,data:s,nonce:o,to:i,value:u,accessList:c,gasPrice:a}=e;Da(e);const f=Je(c),p=[P(n),o?P(o):"0x",a?P(a):"0x",r?P(r):"0x",i??"0x",u?P(u):"0x",s??"0x",f,...ve(e,t)];return xe(["0x01",ie(p)])}function Na(e,t){const{chainId:n=0,gas:r,data:s,nonce:o,to:i,value:u,gasPrice:c}=e;Aa(e);let a=[o?P(o):"0x",c?P(c):"0x",r?P(r):"0x",i??"0x",u?P(u):"0x",s??"0x"];if(t){const f=(()=>{if(t.v>=35n)return(t.v-35n)/2n>0?t.v:27n+(t.v===35n?0n:1n);if(n>0)return BigInt(n*2)+BigInt(35n+t.v-27n);const l=27n+(t.v===27n?0n:1n);if(t.v!==l)throw new vs({v:t.v});return l})(),p=be(t.r),d=be(t.s);a=[...a,P(f),p==="0x00"?"0x":p,d==="0x00"?"0x":d]}else n>0&&(a=[...a,P(n),"0x","0x"]);return ie(a)}function ve(e,t){const n=t??e,{v:r,yParity:s}=n;if(typeof n.r>"u")return[];if(typeof n.s>"u")return[];if(typeof r>"u"&&typeof s>"u")return[];const o=be(n.r),i=be(n.s);return[typeof s=="number"?s?P(1):"0x":r===0n?"0x":r===1n?P(1):r===27n?"0x":P(1),o==="0x00"?"0x":o,i==="0x00"?"0x":i]}function Sa(e){if(!e||e.length===0)return[];const t=[];for(const n of e){const{chainId:r,nonce:s,...o}=n,i=n.address;t.push([r?W(r):"0x",i,s?W(s):"0x",...ve({},o)])}return t}const sr={gasPriceOracle:{address:"0x420000000000000000000000000000000000000F"},l1Block:{address:"0x4200000000000000000000000000000000000015"},l2CrossDomainMessenger:{address:"0x4200000000000000000000000000000000000007"},l2Erc721Bridge:{address:"0x4200000000000000000000000000000000000014"},l2StandardBridge:{address:"0x4200000000000000000000000000000000000010"},l2ToL1MessagePasser:{address:"0x4200000000000000000000000000000000000016"}},_a={block:Zn({format(e){return{transactions:e.transactions?.map(n=>{if(typeof n=="string")return n;const r=Jn(n);return r.typeHex==="0x7e"&&(r.isSystemTx=n.isSystemTx,r.mint=n.mint?re(n.mint):void 0,r.sourceHash=n.sourceHash,r.type="deposit"),r}),stateRoot:e.stateRoot}}}),transaction:Vn({format(e){const t={};return e.type==="0x7e"&&(t.isSystemTx=e.isSystemTx,t.mint=e.mint?re(e.mint):void 0,t.sourceHash=e.sourceHash,t.type="deposit"),t}}),transactionReceipt:ks({format(e){return{l1GasPrice:e.l1GasPrice?re(e.l1GasPrice):null,l1GasUsed:e.l1GasUsed?re(e.l1GasUsed):null,l1Fee:e.l1Fee?re(e.l1Fee):null,l1FeeScalar:e.l1FeeScalar?Number(e.l1FeeScalar):null}}})};function ar(e,t){return Ra(e)?qa(e):Ta(e,t)}const Ua={transaction:ar};function qa(e){La(e);const{sourceHash:t,data:n,from:r,gas:s,isSystemTx:o,mint:i,to:u,value:c}=e,a=[t,r,u??"0x",i?W(i):"0x",c?W(c):"0x",s?W(s):"0x",o?"0x1":"0x",n??"0x"];return xe(["0x7e",ie(a)])}function Ra(e){return e.type==="deposit"||typeof e.sourceHash<"u"}function La(e){const{from:t,to:n}=e;if(t&&!V(t))throw new Z({address:t});if(n&&!V(n))throw new Z({address:n})}const ce={blockTime:2e3,contracts:sr,formatters:_a,serializers:Ua},$a=$({id:31337,name:"Anvil",nativeCurrency:{decimals:18,name:"Ether",symbol:"ETH"},rpcUrls:{default:{http:["http://127.0.0.1:8545"],webSocket:["ws://127.0.0.1:8545"]}}}),Ka=$({id:42161,name:"Arbitrum One",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockTime:250,rpcUrls:{default:{http:["https://arb1.arbitrum.io/rpc"]}},blockExplorers:{default:{name:"Arbiscan",url:"https://arbiscan.io",apiUrl:"https://api.arbiscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:7654707}}}),Fa=$({id:421614,name:"Arbitrum Sepolia",blockTime:250,nativeCurrency:{name:"Arbitrum Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia-rollup.arbitrum.io/rpc"]}},blockExplorers:{default:{name:"Arbiscan",url:"https://sepolia.arbiscan.io",apiUrl:"https://api-sepolia.arbiscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:81930}},testnet:!0}),Ee=1,ht=$({...ce,id:8453,name:"Base",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://mainnet.base.org"]}},blockExplorers:{default:{name:"Basescan",url:"https://basescan.org",apiUrl:"https://api.basescan.org/api"}},contracts:{...ce.contracts,disputeGameFactory:{[Ee]:{address:"0x43edB88C4B80fDD2AdFF2412A7BebF9dF42cB40e"}},l2OutputOracle:{[Ee]:{address:"0x56315b90c40730925ec5485cf004d835058518A0"}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:5022},portal:{[Ee]:{address:"0x49048044D57e1C92A77f79988d21Fa8fAF74E97e",blockCreated:17482143}},l1StandardBridge:{[Ee]:{address:"0x3154Cf16ccdb4C6d922629664174b904d80F2C35",blockCreated:17482143}}},sourceId:Ee});({...ht});const je=11155111,or=$({...ce,id:84532,network:"base-sepolia",name:"Base Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.base.org"]}},blockExplorers:{default:{name:"Basescan",url:"https://sepolia.basescan.org",apiUrl:"https://api-sepolia.basescan.org/api"}},contracts:{...ce.contracts,disputeGameFactory:{[je]:{address:"0xd6E6dBf4F7EA0ac412fD8b65ED297e64BB7a06E1"}},l2OutputOracle:{[je]:{address:"0x84457ca9D0163FbC4bbfe4Dfbb20ba46e48DF254"}},portal:{[je]:{address:"0x49f53e41452c74589e85ca1677426ba426459e85",blockCreated:4446677}},l1StandardBridge:{[je]:{address:"0xfd0Bf71F60660E2f608ed56e1659C450eB113120",blockCreated:4446677}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:1059647}},testnet:!0,sourceId:je});({...or});const Ba=$({id:56,name:"BNB Smart Chain",blockTime:750,nativeCurrency:{decimals:18,name:"BNB",symbol:"BNB"},rpcUrls:{default:{http:["https://56.rpc.thirdweb.com"]}},blockExplorers:{default:{name:"BscScan",url:"https://bscscan.com",apiUrl:"https://api.bscscan.com/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:15921452}}}),Ya={estimateFeesPerGas:async e=>{if(!e.request?.feeCurrency)return null;const[t,n]=await Promise.all([Ha(e.client,e.request.feeCurrency),Qa(e.client,e.request.feeCurrency)]);return{maxFeePerGas:e.multiply(t-n)+n,maxPriorityFeePerGas:n}}};async function Ha(e,t){const n=await e.request({method:"eth_gasPrice",params:[t]});return BigInt(n)}async function Qa(e,t){const n=await e.request({method:"eth_maxPriorityFeePerGas",params:[t]});return BigInt(n)}function ir(e){return e===0||e===0n||e===void 0||e===null||e==="0"||e===""||typeof e=="string"&&(be(e).toLowerCase()==="0x"||be(e).toLowerCase()==="0x00")}function Oe(e){return!ir(e)}function Wa(e){return typeof e.maxFeePerGas<"u"&&typeof e.maxPriorityFeePerGas<"u"}function cr(e){return e.type==="cip64"?!0:Wa(e)&&Oe(e.feeCurrency)}const Ga={block:Zn({format(e){return{transactions:e.transactions?.map(n=>typeof n=="string"?n:{...Jn(n),...n.gatewayFee?{gatewayFee:re(n.gatewayFee),gatewayFeeRecipient:n.gatewayFeeRecipient}:{},feeCurrency:n.feeCurrency})}}}),transaction:Vn({format(e){if(e.type==="0x7e")return{isSystemTx:e.isSystemTx,mint:e.mint?re(e.mint):void 0,sourceHash:e.sourceHash,type:"deposit"};const t={feeCurrency:e.feeCurrency};return e.type==="0x7b"?t.type="cip64":(e.type==="0x7c"&&(t.type="cip42"),t.gatewayFee=e.gatewayFee?re(e.gatewayFee):null,t.gatewayFeeRecipient=e.gatewayFeeRecipient),t}}),transactionRequest:Es({format(e){const t={};return e.feeCurrency&&(t.feeCurrency=e.feeCurrency),cr(e)&&(t.type="0x7b"),t}})};function Va(e,t){return cr(e)?Ja(e,t):ar(e,t)}const Za={transaction:Va};function Ja(e,t){eo(e);const{chainId:n,gas:r,nonce:s,to:o,value:i,maxFeePerGas:u,maxPriorityFeePerGas:c,accessList:a,feeCurrency:f,data:p}=e,d=[W(n),s?W(s):"0x",c?W(c):"0x",u?W(u):"0x",r?W(r):"0x",o??"0x",i?W(i):"0x",p??"0x",Je(a),f,...ve(e,t)];return xe(["0x7b",ie(d)])}const Xa=kt;function eo(e){const{chainId:t,maxPriorityFeePerGas:n,gasPrice:r,maxFeePerGas:s,to:o,feeCurrency:i}=e;if(t<=0)throw new Ze({chainId:t});if(o&&!V(o))throw new Z({address:o});if(r)throw new de("`gasPrice` is not a valid CIP-64 Transaction attribute.");if(Oe(s)&&s>Xa)throw new Et({maxFeePerGas:s});if(Oe(n)&&Oe(s)&&n>s)throw new Gn({maxFeePerGas:s,maxPriorityFeePerGas:n});if(Oe(i)&&!V(i))throw new de("`feeCurrency` MUST be a token address for CIP-64 transactions.");if(ir(i))throw new de("`feeCurrency` must be provided for CIP-64 transactions.")}const to={blockTime:1e3,contracts:sr,formatters:Ga,serializers:Za,fees:Ya},no=$({...to,id:42220,name:"Celo",nativeCurrency:{decimals:18,name:"CELO",symbol:"CELO"},rpcUrls:{default:{http:["https://forno.celo.org"]}},blockExplorers:{default:{name:"Celo Explorer",url:"https://celoscan.io",apiUrl:"https://api.celoscan.io/api"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:13112599}},testnet:!1}),De=1,ro=$({...ce,id:10,name:"OP Mainnet",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://mainnet.optimism.io"]}},blockExplorers:{default:{name:"Optimism Explorer",url:"https://optimistic.etherscan.io",apiUrl:"https://api-optimistic.etherscan.io/api"}},contracts:{...ce.contracts,disputeGameFactory:{[De]:{address:"0xe5965Ab5962eDc7477C8520243A95517CD252fA9"}},l2OutputOracle:{[De]:{address:"0xdfe97868233d1aa22e815a266982f2cf17685a27"}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:4286263},portal:{[De]:{address:"0xbEb5Fc579115071764c7423A4f12eDde41f106Ed"}},l1StandardBridge:{[De]:{address:"0x99C9fc46f92E8a1c0deC1b1747d010903E884bE1"}}},sourceId:De}),Ae=11155111,so=$({...ce,id:11155420,name:"OP Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.optimism.io"]}},blockExplorers:{default:{name:"Blockscout",url:"https://optimism-sepolia.blockscout.com",apiUrl:"https://optimism-sepolia.blockscout.com/api"}},contracts:{...ce.contracts,disputeGameFactory:{[Ae]:{address:"0x05F9613aDB30026FFd634f38e5C4dFd30a197Fa1"}},l2OutputOracle:{[Ae]:{address:"0x90E9c4f8a994a250F6aEfd61CAFb4F2e895D458F"}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:1620204},portal:{[Ae]:{address:"0x16Fc5058F25648194471939df75CF27A2fdC48BC"}},l1StandardBridge:{[Ae]:{address:"0xFBb0621E0B23b5478B630BD55a5f21f67730B0F1"}}},testnet:!0,sourceId:Ae}),ao=$({id:137,name:"Polygon",nativeCurrency:{name:"POL",symbol:"POL",decimals:18},rpcUrls:{default:{http:["https://polygon-rpc.com"]}},blockExplorers:{default:{name:"PolygonScan",url:"https://polygonscan.com",apiUrl:"https://api.polygonscan.com/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:25770160}}}),oo=$({id:11155111,name:"Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.drpc.org"]}},blockExplorers:{default:{name:"Etherscan",url:"https://sepolia.etherscan.io",apiUrl:"https://api-sepolia.etherscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:751532},ensUniversalResolver:{address:"0xeeeeeeee14d718c2b47d9923deab1335e144eeee",blockCreated:8928790}},testnet:!0});function Tt(e,t={}){return $r(e,t)}function io(e,t,n){if(t==="Error")return kn;if(t==="Panic")return En;if(sn(t,{strict:!1})){const s=Ue(t,0,4);if(s===uo)return kn;if(s===lo)return En}const r=Kr(e,t,n);if(r.type!=="error")throw new Fr({name:t,type:"error"});return r}function co(e){return Bn(e)}const kn=Tt({inputs:[{name:"message",type:"string"}],name:"Error",type:"error"}),uo="0x08c379a0",En=Tt({inputs:[{name:"reason",type:"uint8"}],name:"Panic",type:"error"}),lo="0x4e487b71",fo=new TextEncoder,po=new TextDecoder,Xe=Object.fromEntries(Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").map((e,t)=>[t,e.charCodeAt(0)])),et={...Object.fromEntries(Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").map((e,t)=>[e.charCodeAt(0),t])),61:0,45:62,95:63};function ho(e,t={}){const{pad:n=!0,url:r=!1}=t,s=new Uint8Array(Math.ceil(e.length/3)*4);for(let c=0,a=0;a<e.length;c+=4,a+=3){const f=(e[a]<<16)+(e[a+1]<<8)+(e[a+2]|0);s[c]=Xe[f>>18],s[c+1]=Xe[f>>12&63],s[c+2]=Xe[f>>6&63],s[c+3]=Xe[f&63]}const o=e.length%3,i=Math.floor(e.length/3)*4+(o&&o+1);let u=po.decode(new Uint8Array(s.buffer,0,i));return n&&o===1&&(u+="=="),n&&o===2&&(u+="="),r&&(u=u.replaceAll("+","-").replaceAll("/","_")),u}function yo(e,t={}){return ho(ut(e),t)}function Lt(e){const t=e.replace(/=+$/,""),n=t.length,r=new Uint8Array(n+3);fo.encodeInto(t+"===",r);for(let o=0,i=0;o<t.length;o+=4,i+=3){const u=(et[r[o]]<<18)+(et[r[o+1]]<<12)+(et[r[o+2]]<<6)+et[r[o+3]];r[i]=u>>16,r[i+1]=u>>8&255,r[i+2]=u&255}const s=(n>>2)*3+(n%4&&n%4-1);return new Uint8Array(r.buffer,0,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ur=tn(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),mo=ur.create(BigInt("-3")),go=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),dr=en({a:mo,b:go,Fp:ur,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},js),lr=tn(BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff")),bo=lr.create(BigInt("-3")),wo=BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef");en({a:bo,b:wo,Fp:lr,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},Ds);const fr=tn(BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")),Io=fr.create(BigInt("-3")),Mo=BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00");en({a:Io,b:Mo,Fp:fr,n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1),lowS:!1,allowedPrivateKeyLengths:[130,131,132]},As);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const yt=dr,dn=dr;function xo(e){const{privateKey:t}=e,n=dn.ProjectivePoint.fromPrivateKey(typeof t=="string"?t.slice(2):qe(t).slice(2));return dt(n)}function vo(e={}){const{as:t="Hex"}=e,n=dn.utils.randomPrivateKey();return t==="Hex"?qe(n):n}function jn(e){const{extraEntropy:t=Br,hash:n,payload:r,privateKey:s}=e,{r:o,s:i,recovery:u}=dn.sign(r instanceof Uint8Array?r:ut(r),s instanceof Uint8Array?s:ut(s),{extraEntropy:typeof t=="boolean"?t:Xn(t).slice(2),lowS:!0,...n?{prehash:!0}:{}});return{r:o,s:i,yParity:u}}function ko(e){const t=Xn(e);return jt("0x19",X(`Ethereum Signed Message:
`+we(t)),t)}function tt(e){return F(ko(e))}function Eo(e,t={}){const{raw:n=!1}=t,r=e;if(n)return e;if(r.error)throw pr(r.error);return r.result}function pr(e){const t=e;if(t instanceof Error&&!("code"in t))return new ae({cause:t,data:t,message:t.message,stack:t.stack});const{code:n}=t;return n===ae.code?new ae(t):n===Re.code?new Re(t):n===he.code?new he(t):n===Be.code?new Be(t):n===Ke.code?new Ke(t):n===Ye.code?new Ye(t):n===pe.code?new pe(t):n===He.code?new He(t):n===Le.code?new Le(t):n===$e.code?new $e(t):n===fe.code?new fe(t):n===Fe.code?new Fe(t):new ae({cause:t instanceof Error?t:void 0,data:t,message:t.message,stack:t instanceof Error?t.stack:void 0})}class H extends Error{constructor(t){const{cause:n,code:r,message:s,data:o,stack:i}=t;super(s,{cause:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.BaseError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stack",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=n,this.code=r,this.data=o,this.stack=i??""}}class Re extends H{constructor(t={}){super({code:Re.code,data:t.data,message:t.message??"Missing or invalid parameters."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.InvalidInputError"})}}Object.defineProperty(Re,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class Le extends H{constructor(t={}){super({code:Le.code,data:t.data,message:t.message??"Requested resource not found."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.ResourceNotFoundError"})}}Object.defineProperty(Le,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class $e extends H{constructor(t={}){super({code:$e.code,data:t.data,message:t.message??"Requested resource not available."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.ResourceUnavailableError"})}}Object.defineProperty($e,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class fe extends H{constructor(t={}){super({code:fe.code,data:t.data,message:t.message??"Transaction creation failed."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.TransactionRejectedError"})}}Object.defineProperty(fe,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class pe extends H{constructor(t={}){super({code:pe.code,data:t.data,message:t.message??"Method is not implemented."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.MethodNotSupportedError"})}}Object.defineProperty(pe,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class Ke extends H{constructor(t={}){super({code:Ke.code,data:t.data,message:t.message??"Rate limit exceeded."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.LimitExceededError"})}}Object.defineProperty(Ke,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class Fe extends H{constructor(t={}){super({code:Fe.code,data:t.data,message:t.message??"JSON-RPC version not supported."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.VersionNotSupportedError"})}}Object.defineProperty(Fe,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class Be extends H{constructor(t={}){super({code:Be.code,data:t.data,message:t.message??"Input is not a valid JSON-RPC request."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.InvalidRequestError"})}}Object.defineProperty(Be,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class Ye extends H{constructor(t={}){super({code:Ye.code,data:t.data,message:t.message??"Method does not exist."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.MethodNotFoundError"})}}Object.defineProperty(Ye,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class he extends H{constructor(t={}){super({code:he.code,data:t.data,message:t.message??"Invalid method parameters."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.InvalidParamsError"})}}Object.defineProperty(he,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class ae extends H{constructor(t={}){super({cause:t.cause,code:ae.code,data:t.data,message:t.message??"Internal JSON-RPC error.",stack:t.stack}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.InternalError"})}}Object.defineProperty(ae,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class He extends H{constructor(t={}){super({code:He.code,data:t.data,message:t.message??"Failed to parse JSON-RPC response."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.ParseError"})}}Object.defineProperty(He,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class Y extends Error{constructor(t,n){super(n),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ProviderRpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=t,this.details=n}}class Ie extends Y{constructor({message:t="The user rejected the request."}={}){super(4001,t),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.UserRejectedRequestError"})}}Object.defineProperty(Ie,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class _ extends Y{constructor({message:t="The requested method and/or account has not been authorized by the user."}={}){super(4100,t),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.UnauthorizedError"})}}Object.defineProperty(_,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class Qe extends Y{constructor({message:t="The provider does not support the requested method."}={}){super(4200,t),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.UnsupportedMethodError"})}}Object.defineProperty(Qe,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class U extends Y{constructor({message:t="The provider is disconnected from all chains."}={}){super(4900,t),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.DisconnectedError"})}}Object.defineProperty(U,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class se extends Y{constructor({message:t="The provider is not connected to the requested chain."}={}){super(4901,t),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.ChainDisconnectedError"})}}Object.defineProperty(se,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class $t extends Y{constructor({message:t="An error occurred when attempting to switch chain."}={}){super(4902,t),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.SwitchChainError"})}}Object.defineProperty($t,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class Kt extends Y{constructor({message:t="This Wallet does not support a capability that was not marked as optional."}={}){super(5700,t),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.UnsupportedNonOptionalCapabilityError"})}}Object.defineProperty(Kt,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class mt extends Y{constructor({message:t="This Wallet does not support the requested chain ID."}={}){super(5710,t),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.UnsupportedChainIdError"})}}Object.defineProperty(mt,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class Ft extends Y{constructor({message:t="There is already a bundle submitted with this ID."}={}){super(5720,t),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.DuplicateIdError"})}}Object.defineProperty(Ft,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class We extends Y{constructor({message:t="This bundle id is unknown / has not been submitted."}={}){super(5730,t),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.UnknownBundleIdError"})}}Object.defineProperty(We,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class Bt extends Y{constructor({message:t="The call bundle is too large for the Wallet to process."}={}){super(5740,t),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.BundleTooLargeError"})}}Object.defineProperty(Bt,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class Yt extends Y{constructor({message:t="The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."}={}){super(5750,t),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.AtomicReadyWalletRejectedUpgradeError"})}}Object.defineProperty(Yt,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class Ht extends Y{constructor({message:t="The wallet does not support atomic execution but the request requires it."}={}){super(5760,t),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.AtomicityNotSupportedError"})}}Object.defineProperty(Ht,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});function jo(){const e=new Ts;return{get eventNames(){return e.eventNames.bind(e)},get listenerCount(){return e.listenerCount.bind(e)},get listeners(){return e.listeners.bind(e)},addListener:e.addListener.bind(e),emit:e.emit.bind(e),off:e.off.bind(e),on:e.on.bind(e),once:e.once.bind(e),removeAllListeners:e.removeAllListeners.bind(e),removeListener:e.removeListener.bind(e)}}function hr(e,t={}){const{includeEvents:n=!0}=t;if(!e)throw new Do;return{...n?{on:e.on?.bind(e),removeListener:e.removeListener?.bind(e)}:{},async request(r){try{const s=await e.request(r);return s&&typeof s=="object"&&"jsonrpc"in s?Eo(s):s}catch(s){throw yr(s)}}}}function yr(e){const t=pr(e);if(t instanceof ae){if(!t.data)return t;const{code:n}=t.data;if(n===U.code)return new U(t);if(n===se.code)return new se(t);if(n===Ie.code)return new Ie(t);if(n===_.code)return new _(t);if(n===Qe.code)return new Qe(t);if(n===$t.code)return new $t(t);if(n===Yt.code)return new Yt(t);if(n===Ht.code)return new Ht(t);if(n===Bt.code)return new Bt(t);if(n===We.code)return new We(t);if(n===Ft.code)return new Ft(t);if(n===mt.code)return new mt(t);if(n===Kt.code)return new Kt(t)}return t}class Do extends J{constructor(){super("`provider` is undefined."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.IsUndefinedError"})}}function Ao(e={}){let t=e.id??0;return{prepare(n){return To({id:t++,...n})},get id(){return t}}}function To(e){return{...e,jsonrpc:"2.0"}}const Po=/^([a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}(:[0-9]{1,5})?$/,zo=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(:[0-9]{1,5})?$/,Co=/^localhost(:[0-9]{1,5})?$/,Oo=/^[a-zA-Z0-9]{8,}$/,No=/^([a-zA-Z][a-zA-Z0-9+-.]*)$/,So=/^(?:(?<scheme>[a-zA-Z][a-zA-Z0-9+-.]*):\/\/)?(?<domain>[a-zA-Z0-9+-.]*(?::[0-9]{1,5})?) (?:wants you to sign in with your Ethereum account:\n)(?<address>0x[a-fA-F0-9]{40})\n\n(?:(?<statement>.*)\n\n)?/,_o=/(?:URI: (?<uri>.+))\n(?:Version: (?<version>.+))\n(?:Chain ID: (?<chainId>\d+))\n(?:Nonce: (?<nonce>[a-zA-Z0-9]+))\n(?:Issued At: (?<issuedAt>.+))(?:\nExpiration Time: (?<expirationTime>.+))?(?:\nNot Before: (?<notBefore>.+))?(?:\nRequest ID: (?<requestId>.+))?/;function Uo(e){const{chainId:t,domain:n,expirationTime:r,issuedAt:s=new Date,nonce:o,notBefore:i,requestId:u,resources:c,scheme:a,uri:f,version:p}=e;{if(t!==Math.floor(t))throw new te({field:"chainId",metaMessages:["- Chain ID must be a EIP-155 chain ID.","- See https://eips.ethereum.org/EIPS/eip-155","",`Provided value: ${t}`]});if(!(Po.test(n)||zo.test(n)||Co.test(n)))throw new te({field:"domain",metaMessages:["- Domain must be an RFC 3986 authority.","- See https://www.rfc-editor.org/rfc/rfc3986","",`Provided value: ${n}`]});if(!Oo.test(o))throw new te({field:"nonce",metaMessages:["- Nonce must be at least 8 characters.","- Nonce must be alphanumeric.","",`Provided value: ${o}`]});if(!Dn(f))throw new te({field:"uri",metaMessages:["- URI must be a RFC 3986 URI referring to the resource that is the subject of the signing.","- See https://www.rfc-editor.org/rfc/rfc3986","",`Provided value: ${f}`]});if(p!=="1")throw new te({field:"version",metaMessages:["- Version must be '1'.","",`Provided value: ${p}`]});if(a&&!No.test(a))throw new te({field:"scheme",metaMessages:["- Scheme must be an RFC 3986 URI scheme.","- See https://www.rfc-editor.org/rfc/rfc3986#section-3.1","",`Provided value: ${a}`]});const g=e.statement;if(g?.includes(`
`))throw new te({field:"statement",metaMessages:["- Statement must not include '\\n'.","",`Provided value: ${g}`]})}const d=Yr(e.address,{checksum:!0}),l=a?`${a}://${n}`:n,h=e.statement?`${e.statement}
`:"",y=`${l} wants you to sign in with your Ethereum account:
${d}

${h}`;let m=`URI: ${f}
Version: ${p}
Chain ID: ${t}
Nonce: ${o}
Issued At: ${s.toISOString()}`;if(r&&(m+=`
Expiration Time: ${r.toISOString()}`),i&&(m+=`
Not Before: ${i.toISOString()}`),u&&(m+=`
Request ID: ${u}`),c){let g=`
Resources:`;for(const b of c){if(!Dn(b))throw new te({field:"resources",metaMessages:["- Every resource must be a RFC 3986 URI.","- See https://www.rfc-editor.org/rfc/rfc3986","",`Provided value: ${b}`]});g+=`
- ${b}`}m+=g}return`${y}
${m}`}function Dn(e){if(/[^a-z0-9:/?#[\]@!$&'()*+,;=.\-_~%]/i.test(e)||/%[^0-9a-f]/i.test(e)||/%[0-9a-f](:?[^0-9a-f]|$)/i.test(e))return!1;const t=qo(e),n=t[1],r=t[2],s=t[3],o=t[4],i=t[5];if(!(n?.length&&s&&s.length>=0))return!1;if(r?.length){if(!(s.length===0||/^\//.test(s)))return!1}else if(/^\/\//.test(s))return!1;if(!/^[a-z][a-z0-9+\-.]*$/.test(n.toLowerCase()))return!1;let u="";return u+=`${n}:`,r?.length&&(u+=`//${r}`),u+=s,o?.length&&(u+=`?${o}`),i?.length&&(u+=`#${i}`),u}function qo(e){return e.match(/(?:([^:/?#]+):)?(?:\/\/([^/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/)}function Ro(e){const{scheme:t,statement:n,...r}=e.match(So)?.groups??{},{chainId:s,expirationTime:o,issuedAt:i,notBefore:u,requestId:c,...a}=e.match(_o)?.groups??{},f=e.split("Resources:")[1]?.split(`
- `).slice(1);return{...r,...a,...s?{chainId:Number(s)}:{},...o?{expirationTime:new Date(o)}:{},...i?{issuedAt:new Date(i)}:{},...u?{notBefore:new Date(u)}:{},...c?{requestId:c}:{},...f?{resources:f}:{},...t?{scheme:t}:{},...n?{statement:n}:{}}}class te extends J{constructor(t){const{field:n,metaMessages:r}=t;super(`Invalid Sign-In with Ethereum message field "${n}".`,{metaMessages:r}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Siwe.InvalidMessageFieldError"})}}function mr(e,t=0){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(e))throw new Lo({value:e});let[n="",r="0"]=e.split(".");const s=n.startsWith("-");if(s&&(n=n.slice(1)),r=r.replace(/(0+)$/,""),t===0)Math.round(+`.${r}`)===1&&(n=`${BigInt(n)+1n}`),r="";else if(r.length>t){const[o,i,u]=[r.slice(0,t-1),r.slice(t-1,t),r.slice(t)],c=Math.round(+`${i}.${u}`);c>9?r=`${BigInt(o)+BigInt(1)}0`.padStart(o.length+1,"0"):r=`${o}${c}`,r.length>t&&(r=r.slice(1),n=`${BigInt(n)+1n}`),r=r.slice(0,t)}else r=r.padEnd(t,"0");return BigInt(`${s?"-":""}${n}${r}`)}class Lo extends J{constructor({value:t}){super(`Value \`${t}\` is not a valid decimal number.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Value.InvalidDecimalNumberError"})}}function $o(e){const{domain:t,message:n,primaryType:r,types:s}=e,o=(i,u)=>{for(const c of i){const{name:a,type:f}=c,p=u[a],d=f.match(Hr);if(d&&(typeof p=="number"||typeof p=="bigint")){const[,y,m]=d;q(p,{signed:y==="int",size:Number.parseInt(m??"",10)/8})}if(f==="address"&&typeof p=="string"&&!Mt(p))throw new Qr({address:p,cause:new Wr});const l=f.match(Gr);if(l){const[,y]=l;if(y&&we(p)!==Number.parseInt(y,10))throw new Yo({expectedSize:Number.parseInt(y,10),givenSize:we(p)})}const h=s[f];h&&(Vo(f),o(h,p))}};if(s.EIP712Domain&&t){if(typeof t!="object")throw new Ho({domain:t});o(s.EIP712Domain,t)}if(r!=="EIP712Domain")if(s[r])o(s[r],n);else throw new Qo({primaryType:r,types:s})}function Ko(e){const{domain:t={},message:n,primaryType:r}=e,s={EIP712Domain:gr(t),...e.types};$o({domain:t,message:n,primaryType:r,types:s});const o=["0x19","0x01"];return t&&o.push(Bo({domain:t,types:s})),r!=="EIP712Domain"&&o.push(br({data:n,primaryType:r,types:s})),jt(...o)}function Fo(e){const{primaryType:t,types:n}=e;let r="";const s=Mr({primaryType:t,types:n});s.delete(t);const o=[t,...Array.from(s).sort()];for(const i of o)r+=`${i}(${(n[i]??[]).map(({name:u,type:c})=>`${c} ${u}`).join(",")})`;return r}function gr(e){return[typeof e?.name=="string"&&{name:"name",type:"string"},e?.version&&{name:"version",type:"string"},(typeof e?.chainId=="number"||typeof e?.chainId=="bigint")&&{name:"chainId",type:"uint256"},e?.verifyingContract&&{name:"verifyingContract",type:"address"},e?.salt&&{name:"salt",type:"bytes32"}].filter(Boolean)}function ln(e){return F(Ko(e))}function Bo(e){const{domain:t,types:n}=e;return br({data:t,primaryType:"EIP712Domain",types:{...n,EIP712Domain:n?.EIP712Domain||gr(t)}})}function br(e){const{data:t,primaryType:n,types:r}=e,s=wr({data:t,primaryType:n,types:r});return F(s)}class Yo extends J{constructor({expectedSize:t,givenSize:n}){super(`Expected bytes${t}, got bytes${n}.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TypedData.BytesSizeMismatchError"})}}class Ho extends J{constructor({domain:t}){super(`Invalid domain "${lt(t)}".`,{metaMessages:["Must be a valid EIP-712 domain."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TypedData.InvalidDomainError"})}}class Qo extends J{constructor({primaryType:t,types:n}){super(`Invalid primary type \`${t}\` must be one of \`${JSON.stringify(Object.keys(n))}\`.`,{metaMessages:["Check that the primary type is a key in `types`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TypedData.InvalidPrimaryTypeError"})}}class Wo extends J{constructor({type:t}){super(`Struct type "${t}" is invalid.`,{metaMessages:["Struct type must not be a Solidity type."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TypedData.InvalidStructTypeError"})}}function wr(e){const{data:t,primaryType:n,types:r}=e,s=[{type:"bytes32"}],o=[Go({primaryType:n,types:r})];for(const i of r[n]??[]){const[u,c]=Ir({types:r,name:i.name,type:i.type,value:t[i.name]});s.push(u),o.push(c)}return xt(s,o)}function Go(e){const{primaryType:t,types:n}=e,r=X(Fo({primaryType:t,types:n}));return F(r)}function Ir(e){let{types:t,name:n,type:r,value:s}=e;if(t[r]!==void 0)return[{type:"bytes32"},F(wr({data:s,primaryType:r,types:t}))];if(r==="bytes")return s=`0x${(s.length%2?"0":"")+s.slice(2)}`,[{type:"bytes32"},F(s,{as:"Hex"})];if(r==="string")return[{type:"bytes32"},F(nn(s),{as:"Hex"})];if(r.lastIndexOf("]")===r.length-1){const o=r.slice(0,r.lastIndexOf("[")),i=s.map(u=>Ir({name:n,type:o,types:t,value:u}));return[{type:"bytes32"},F(xt(i.map(([u])=>u),i.map(([,u])=>u)))]}return[{type:r},s]}function Mr(e,t=new Set){const{primaryType:n,types:r}=e,o=n.match(/^\w*/u)?.[0];if(t.has(o)||r[o]===void 0)return t;t.add(o);for(const i of r[o])Mr({primaryType:i.type,types:r},t);return t}function Vo(e){if(e==="address"||e==="bool"||e==="string"||e.startsWith("bytes")||e.startsWith("uint")||e.startsWith("int"))throw new Wo({type:e})}function Zo(e){const t=e[4]===0?5:4,n=t+32,r=e[n+2]===0?n+3:n+2,s=BigInt(qe(e.slice(t,n))),o=BigInt(qe(e.slice(r)));return{r:s,s:o>yt.CURVE.n/2n?yt.CURVE.n-o:o}}async function Jo(e){try{const t=e.getPublicKey();if(!t)throw new gt;const n=new Uint8Array(t),r=await crypto.subtle.importKey("spki",new Uint8Array(n),{name:"ECDSA",namedCurve:"P-256",hash:"SHA-256"},!0,["verify"]),s=new Uint8Array(await crypto.subtle.exportKey("raw",r));return dt(s)}catch(t){if(t.message!=="Permission denied to access object")throw t;const n=new Uint8Array(e.attestationObject),r=32,s=88,o=c=>{const a=new Uint8Array([c,s,r]);for(let f=0;f<n.length-a.length;f++)if(a.every((p,d)=>n[f+d]===p))return f+a.length;throw new gt},i=o(33),u=o(34);return dt(new Uint8Array([4,...n.slice(i,i+r),...n.slice(u,u+r)]))}}const Xo=Uint8Array.from([105,171,180,181,160,222,75,198,42,42,32,31,141,37,186,233]);async function ei(e){const{createFn:t=window.navigator.credentials.create.bind(window.navigator.credentials),...n}=e,r=ri(n);try{const s=await t(r);if(!s)throw new gt;const o=s.response,i=await Jo(o);return{id:s.id,publicKey:i,raw:s}}catch(s){throw new gt({cause:s})}}function ti(e={}){const{flag:t=5,rpId:n=window.location.hostname,signCount:r=0}=e,s=Yn(X(n)),o=q(t,{size:1}),i=q(r,{size:4});return jt(s,o,i)}function ni(e){const{challenge:t,crossOrigin:n=!1,extraClientData:r,origin:s=window.location.origin}=e;return JSON.stringify({type:"webauthn.get",challenge:yo(t,{url:!0,pad:!1}),origin:s,crossOrigin:n,...r})}function ri(e){const{attestation:t="none",authenticatorSelection:n={residentKey:"preferred",requireResidentKey:!1,userVerification:"required"},challenge:r=Xo,excludeCredentialIds:s,extensions:o,name:i,rp:u={id:window.location.hostname,name:window.document.title},user:c}=e,a=c?.name??i;return{publicKey:{attestation:t,authenticatorSelection:n,challenge:r,...s?{excludeCredentials:s?.map(f=>({id:Lt(f),type:"public-key"}))}:{},pubKeyCredParams:[{type:"public-key",alg:-7}],...o&&{extensions:o},rp:u,user:{id:c?.id??F(nn(a),{as:"Bytes"}),name:a,displayName:c?.displayName??a}}}}function si(e){const{credentialId:t,challenge:n,extensions:r,rpId:s=window.location.hostname,userVerification:o="required"}=e;return{publicKey:{...t?{allowCredentials:Array.isArray(t)?t.map(i=>({id:Lt(i),type:"public-key"})):[{id:Lt(t),type:"public-key"}]}:{},challenge:ut(n),...r&&{extensions:r},rpId:s,userVerification:o}}}function ai(e){const{challenge:t,crossOrigin:n,extraClientData:r,flag:s,origin:o,rpId:i,signCount:u,userVerification:c="required"}=e,a=ti({flag:s,rpId:i,signCount:u}),f=ni({challenge:t,crossOrigin:n,extraClientData:r,origin:o}),p=Yn(X(f)),d=f.indexOf('"challenge"'),l=f.indexOf('"type"'),h={authenticatorData:a,clientDataJSON:f,challengeIndex:d,typeIndex:l,userVerificationRequired:c==="required"},y=jt(a,p);return{metadata:h,payload:y}}async function xr(e){const{getFn:t=window.navigator.credentials.get.bind(window.navigator.credentials),...n}=e,r=si(n);try{const s=await t(r);if(!s)throw new An;const o=s.response,i=String.fromCharCode(...new Uint8Array(o.clientDataJSON)),u=i.indexOf('"challenge"'),c=i.indexOf('"type"'),a=Zo(new Uint8Array(o.signature));return{metadata:{authenticatorData:qe(new Uint8Array(o.authenticatorData)),clientDataJSON:i,challengeIndex:u,typeIndex:c,userVerificationRequired:r.publicKey.userVerification==="required"},signature:a,raw:s}}catch(s){throw new An({cause:s})}}class gt extends J{constructor({cause:t}={}){super("Failed to create credential.",{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WebAuthnP256.CredentialCreationFailedError"})}}class An extends J{constructor({cause:t}={}){super("Failed to request credential.",{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WebAuthnP256.CredentialRequestFailedError"})}}async function oi(e={}){const{extractable:t=!1}=e,n=await globalThis.crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},t,["sign","verify"]),r=await globalThis.crypto.subtle.exportKey("raw",n.publicKey),s=dt(new Uint8Array(r));return{privateKey:n.privateKey,publicKey:s}}async function ii(e){const{payload:t,privateKey:n}=e,r=await globalThis.crypto.subtle.sign({name:"ECDSA",hash:"SHA-256"},n,Rt(t)),s=Vr(new Uint8Array(r)),o=pn(hn(s,0,32));let i=pn(hn(s,32,64));return i>yt.CURVE.n/2n&&(i=yt.CURVE.n-i),{r:o,s:i}}const ci=Object.freeze(Object.defineProperty({__proto__:null,arbitrum:Ka,arbitrumSepolia:Fa,base:ht,baseSepolia:or,bsc:Ba,celo:no,mainnet:Ps,optimism:ro,optimismSepolia:so,polygon:ao,sepolia:oo},Symbol.toStringTag,{value:"Module"})),ui=[ht,...Object.values(ci).filter(e=>e.id!==ht.id)],vr=$a;({...vr});({...vr});const di=()=>"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in IntersectionObserverEntry.prototype&&"isVisible"in IntersectionObserverEntry.prototype;function li(e={}){const{prefix:t="[Porto]"}=e,n=new Set;return{error:me(console.error,{prefix:t}),errorOnce:me(console.error,{memo:n,prefix:t}),log:me(console.log,{prefix:t}),logOnce:me(console.log,{memo:n,prefix:t}),warn:me(console.warn,{prefix:t}),warnOnce:me(console.warn,{memo:n,prefix:t})}}const Tn=li();function me(e,t={}){const{memo:n,prefix:r}=t;return(...s)=>{const o=s.join(" ");n?.has(o)||(n?.add(o),e(`${r} ${o}`))}}function fi(){const e=navigator.userAgent.toLowerCase();return e.includes("safari")&&!e.includes("chrome")}function pi(){const e=navigator.userAgent.toLowerCase();return(e.includes("firefox")||e.includes("fxios"))&&!e.includes("seamonkey")}function hi(){return window.navigator?.userAgentData?.mobile?!0:navigator.maxTouchPoints>1||/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(navigator.userAgent.slice(0,4))}function yi(){let e=()=>{},t=()=>{};return{promise:new Promise((r,s)=>{e=r,t=s}),reject:t,resolve:e}}function Me(e){if(Array.isArray(e))return e.map(Me);if(typeof e=="function")return;if(typeof e!="object"||e===null)return e;if(Object.getPrototypeOf(e)!==Object.prototype)try{return structuredClone(e)}catch{return}const t={};for(const[n,r]of Object.entries(e))t[n]=Me(r);return t}function kr(e,t){const n=[],r=new Set;for(const s of e){const o=t(s);r.has(o)||(r.add(o),n.push(s))}return n}function fn(){return typeof globalThis<"u"&&"crypto"in globalThis?globalThis.crypto.randomUUID():crypto.randomUUID()}function bt(e,t={}){const{targetOrigin:n}=t,r=new Map;return{destroy(){for(const s of r.values())e.removeEventListener("message",s)},on(s,o,i){function u(c){c.data.topic===s&&(i&&c.data.id!==i||n&&c.origin!==n||o(c.data.payload,c))}return e.addEventListener("message",u),r.set(s,u),()=>e.removeEventListener("message",u)},async send(s,o,i){const u=fn();return e.postMessage(Me({id:u,payload:o,topic:s}),i??n??"*"),{id:u,payload:o,topic:s}},async sendAsync(s,o,i){const{id:u}=await this.send(s,o,i);return new Promise(c=>this.on(s,c,u))}}}function Er(e){const{from:t,to:n,waitForReady:r=!1}=e;let s=!1;const o=yi();t.on("ready",o.resolve);const i={destroy(){t.destroy(),n.destroy(),s&&o.reject()},on(u,c,a){return t.on(u,c,a)},async send(u,c){return s=!0,r&&await o.promise.finally(()=>s=!1),n.send(u,c)},async sendAsync(u,c){return s=!0,r&&await o.promise.finally(()=>s=!1),n.sendAsync(u,c)}};return{...i,ready(u){i.send("ready",u)},waitForReady(){return o.promise}}}const jr={prod:"https://id.porto.sh/dialog"};function mi(e={}){const{skipProtocolCheck:t,skipUnsupported:n}=e,r=s=>!n&&fi()&&s?.some(o=>["wallet_connect","eth_requestAccounts"].includes(o.method));return typeof window>"u"?Dr():{name:"iframe",setup(s){const{host:o,internal:i,theme:u,themeController:c}=s,{store:a}=i,f=gi().setup(s);let p=!1;const d=new URL(o),l=document.createElement("dialog");l.dataset.porto="",l.setAttribute("role","dialog"),l.setAttribute("aria-closed","true"),l.setAttribute("aria-label","Porto Wallet"),l.setAttribute("hidden","until-found"),Object.assign(l.style,{background:"transparent",border:"0",outline:"0",padding:"0",position:"fixed"}),document.body.appendChild(l);const h=document.createElement("iframe");h.setAttribute("data-testid","porto");const y=[`publickey-credentials-get ${d.origin}`,`publickey-credentials-create ${d.origin}`];pi()||y.push("clipboard-write"),h.setAttribute("allow",y.join("; ")),h.setAttribute("tabindex","0"),h.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox"),h.setAttribute("src",Qt(o)),h.setAttribute("title","Porto"),Object.assign(h.style,{backgroundColor:"transparent",border:"0",colorScheme:"light dark",height:"100%",left:"0",position:"fixed",top:"0",width:"100%"});const m=document.createElement("style");m.innerHTML=`
        dialog[data-porto]::backdrop {
          background: transparent!important;
        }
      `,l.appendChild(m),l.appendChild(h);const g=Er({from:bt(window,{targetOrigin:d.origin}),to:bt(h.contentWindow,{targetOrigin:d.origin}),waitForReady:!0});c?._setup(g,!0);const b=window.matchMedia("(max-width: 460px)"),w=()=>{g.send("__internal",{type:"resize",width:b.matches?460:461})};b.addEventListener("change",w),g.on("ready",z=>{let L=s.internal.store.getState().chainIds.filter(S=>z.chainIds.includes(S));L.length===0&&(L=z.chainIds),a.setState(S=>({...S,chainIds:L})),g.send("__internal",{chainIds:L,mode:"iframe",referrer:it(),theme:u,type:"init"}),w()}),g.on("rpc-response",z=>{if(r([z._request])){const K=h.src;h.src=K}Tr(a,z)}),g.on("__internal",z=>{z.type==="switch"&&z.mode==="popup"&&(f.open(),f.syncRequests(a.getState().requestQueue))});let I=null,M=null;const x=()=>wt(a),v=z=>{z.key==="Escape"&&wt(a)},j=new MutationObserver(z=>{for(const K of z){if(K.type!=="attributes")continue;const L=K.attributeName;L&&L==="inert"&&l.removeAttribute(L)}});j.observe(l,{attributeOldValue:!0,attributes:!0});let E=!1;const k=()=>{E&&(E=!1,l.removeEventListener("click",x),document.removeEventListener("keydown",v),l.style.pointerEvents="none",M?.focus(),M=null,Object.assign(document.body.style,I??""),document.body.style.overflow=I?.overflow??"")},C=()=>{E||(E=!0,l.addEventListener("click",x),document.addEventListener("keydown",v),h.focus(),l.style.pointerEvents="auto",I=Object.assign({},document.body.style),document.body.style.overflow="hidden")};let D=!1;const T=()=>{D||(D=!0,document.activeElement instanceof HTMLElement&&(M=document.activeElement),l.removeAttribute("hidden"),l.removeAttribute("aria-closed"),l.showModal())},A=()=>{if(D){D=!1,l.setAttribute("hidden","true"),l.setAttribute("aria-closed","true"),l.close();for(const z of l.parentNode?Array.from(l.parentNode.children):[])z!==l&&z.hasAttribute("inert")&&z.removeAttribute("inert")}};return{close(){f.close(),p=!1,g.send("__internal",{mode:"iframe",referrer:it(),type:"init"}),A(),k()},destroy(){f.close(),p=!1,k(),A(),f.destroy(),g.destroy(),l.remove(),j.disconnect(),b.removeEventListener("change",w)},open(){p||(p=!0,T(),C(),g.send("__internal",{mode:"iframe",referrer:it(),type:"init"}))},async secure(){const{trustedHosts:z}=await g.waitForReady(),K=(()=>{if(t)return!0;const ee=window.location.protocol.startsWith("https");return ee||Tn.warnOnce("Detected insecure protocol (HTTP).",`

The Porto iframe is not supported on HTTP origins (${window.location.origin})`,"due to lack of WebAuthn support.","See https://porto.sh/sdk#secure-origins-https for more information."),ee})(),L=di(),S=!!z?.includes(window.location.hostname),ye=!!(L||S);return ye||Tn.warnOnce([`Warning: Browser does not support IntersectionObserver v2 or host "${d.hostname}" is not trusted by Porto.`,"This may result in the dialog falling back to a popup.","",`Add "${d.hostname}" to the trusted hosts list to enable iframe dialog: https://github.com/ithacaxyz/porto/edit/main/src/trusted-hosts.ts`].join(`
`)),{frame:ye,host:S,protocol:K}},async syncRequests(z){const{methodPolicies:K}=await g.waitForReady(),L=await this.secure(),S=z?.every(ee=>K?.find(zt=>zt.method===ee.request.method)?.modes?.headless===!0),ye=r(z.map(ee=>ee.request));if(!S&&(ye||!L.protocol||!L.frame))f.syncRequests(z);else{const ee=z.some(zt=>Ar(zt.request,{methodPolicies:K,targetOrigin:d.origin}));!p&&ee&&this.open(),g.send("rpc-requests",z)}}}},supportsHeadless:!0}}function gi(e={}){if(typeof window>"u")return Dr();const{type:t="auto",size:n=bi}=e;return{name:"popup",setup(r){const{host:s,internal:o,themeController:i}=r,{store:u}=o,c=new URL(s);let a=null;const f=t==="page"||t==="auto"&&hi()?"page":"popup";function p(){a&&wt(u)}const d=(()=>{const h=setInterval(()=>{a?.closed&&wt(u)},100);return()=>clearInterval(h)})();let l;return i?._setup(null,!0),{close(){a&&(a.close(),a=null)},destroy(){this.close(),window.removeEventListener("focus",p),l?.destroy(),d()},open(){if(f==="popup"){const h=(window.innerWidth-n.width)/2+window.screenX,y=window.screenY+100;a=window.open(Qt(s),"_blank",`width=${n.width},height=${n.height},left=${h},top=${y}`)}else a=window.open(Qt(s),"_blank");if(!a)throw new Error("Failed to open popup");l=Er({from:bt(window,{targetOrigin:c.origin}),to:bt(a,{targetOrigin:c.origin}),waitForReady:!0}),i?._setup(l,!1),l.send("__internal",{mode:f==="page"?"page":"popup",referrer:it(),theme:i?.getTheme()??r.theme,type:"init"}),l.on("rpc-response",h=>Tr(u,h)),window.removeEventListener("focus",p),window.addEventListener("focus",p)},async secure(){return{frame:!0,host:!0,protocol:!0}},async syncRequests(h){h.some(m=>Ar(m.request))&&((!a||a.closed)&&this.open(),a?.focus()),l?.send("rpc-requests",h)}}},supportsHeadless:!1}}function Dr(){return{name:"noop",setup(){return{close(){},destroy(){},open(){},async secure(){return{frame:!0,host:!0,protocol:!0}},async syncRequests(){}}},supportsHeadless:!0}}const bi={height:282,width:360};function Ar(e,t={}){const{methodPolicies:n,targetOrigin:r}=t,s=n?.find(o=>o.method===e.method);return s&&s.modes?.headless?!!(typeof s.modes.headless=="object"&&s.modes.headless.sameOrigin&&r!==window.location.origin):!0}function it(){return{icon:(()=>{const t=document.querySelector('link[rel="icon"][media="(prefers-color-scheme: dark)"]')?.href,n=document.querySelector('link[rel="icon"][media="(prefers-color-scheme: light)"]')?.href??document.querySelector('link[rel="icon"]')?.href;return t&&n&&t!==n?{dark:t,light:n}:window.matchMedia("(prefers-color-scheme: dark)").matches?t:n})(),title:document.title}}function wt(e){e.setState(t=>({...t,requestQueue:t.requestQueue.map(n=>({account:n.account,error:new Ie,request:n.request,status:"error"}))}))}function Tr(e,t){e.setState(n=>({...n,requestQueue:n.requestQueue.map(r=>r.request.id!==t.id?r:t.error?{account:r.account,error:t.error,request:r.request,status:"error"}:{account:r.account,request:r.request,result:t.result,status:"success"})}))}function Qt(e){const t=new URL(e),n=new URLSearchParams(window.location.search),r="porto.";for(const[s,o]of n.entries())s.startsWith(r)&&t.searchParams.set(s.slice(r.length),o);return t.toString()}function wi(e){if(typeof e=="string"){if(!V(e,{strict:!1}))throw new Z({address:e});return{address:e,type:"json-rpc"}}if(!V(e.address,{strict:!1}))throw new Z({address:e.address});return{address:e.address,nonceManager:e.nonceManager,sign:e.sign,signAuthorization:e.signAuthorization,signMessage:e.signMessage,signTransaction:e.signTransaction,signTypedData:e.signTypedData,source:"custom",type:"local"}}const Pr="0x3232323232323232323232323232323232323232",Pn="0x32323232",Ii={p256:"p256",secp256k1:"secp256k1",webauthnp256:"webauthn-p256"},Mi={admin:"admin",normal:"session"},xi={0:"minute",1:"hour",2:"day",3:"week",4:"month",5:"year"},vi={address:"secp256k1",p256:"p256",secp256k1:"secp256k1","webauthn-p256":"webauthnp256"},ki={admin:"admin",session:"normal"},Ei={address:2,p256:0,secp256k1:2,"webauthn-p256":1},zn={day:2,hour:1,minute:0,month:4,week:3,year:5};async function Cn(e){const{createFn:t,label:n,rpId:r,userId:s}=e,o=await ei({authenticatorSelection:{requireResidentKey:!0,residentKey:"required",userVerification:"required"},createFn:t,extensions:{credProps:!0},rp:r?{id:r,name:r}:void 0,user:{displayName:n,id:new Uint8Array(s??nn(n)),name:n}});return zr({...e,credential:{id:o.id,publicKey:o.publicKey},id:s?rn(s):vt(o.publicKey,{includePrefix:!1})})}function On(e={}){const t=vo();return Ai({...e,privateKey:t})}async function ji(e={}){const t=await oi();return Ti({...e,keyPair:t})}function G(e,t={}){const{chainId:n=e.chainId}=t,{expiry:r=0,id:s,prehash:o=!1,role:i="admin",type:u}=e,c=(()=>{const a=e.publicKey;return a==="0x"?a:u==="secp256k1"||u==="address"?we(a)===20||an(Ue(a,0,12))===0n?Ue(a,-20):Qn(Wn(a)):a})();return{...e,chainId:n,expiry:r,hash:Cr({publicKey:c,type:u}),id:(s??c).toLowerCase(),prehash:o,publicKey:c.toLowerCase(),role:i,type:u}}function Di(e,t){const{chainId:n}=t,{publicKey:r}=e,s=we(r)===20||an(Ue(r,0,12))===0n,o={};for(const i of e.permissions)i.type==="call"&&(o.calls??=[],o.calls.push({signature:i.selector,to:i.to===Pr?void 0:i.to})),i.type==="spend"&&(o.spend??=[],o.spend.push({limit:i.limit,period:i.period,token:i.token}));return G({chainId:n,expiry:e.expiry,permissions:o,publicKey:e.publicKey,role:Mi[e.role],type:s?"address":Ii[e.type]})}function zr(e){const{credential:t,id:n,rpId:r}=e,s=vt(t.publicKey,{includePrefix:!1});return G({chainId:e.chainId,expiry:e.expiry??0,feeToken:e.feeToken,id:n,permissions:e.permissions,privateKey:{credential:t,rpId:r},publicKey:s,role:e.role,type:"webauthn-p256"})}function Ai(e){const{privateKey:t}=e,n=vt(xo({privateKey:t}),{includePrefix:!1});return G({chainId:e.chainId,expiry:e.expiry??0,feeToken:e.feeToken,permissions:e.permissions,privateKey:{privateKey(){return t}},publicKey:n,role:e.role,type:"webauthn-p256"})}function Ti(e){const{chainId:t,expiry:n,feeToken:r,keyPair:s,permissions:o,role:i}=e,{privateKey:u}=s,c=vt(s.publicKey,{includePrefix:!1});return G({chainId:t,expiry:n,feeToken:r,permissions:o,prehash:!0,privateKey:u,publicKey:c,role:i,type:"p256"})}function Cr(e){const{type:t}=e,n=Or(e.publicKey);return F(xt([{type:"uint8"},{type:"bytes32"}],[Ei[t],F(n)]))}function Or(e){return we(e)<32?zs(e,32):e}async function le(e,t){const{address:n,storage:r,webAuthn:s,wrap:o=!0}=t,{privateKey:i,publicKey:u,type:c}=e;if(!i)throw new Error(`Key does not have a private key to sign with.

Key:
`+lt(e,null,2));const a=n?ln({domain:{verifyingContract:n},message:{digest:t.payload},primaryType:"ERC1271Sign",types:{ERC1271Sign:[{name:"digest",type:"bytes32"}]}}):t.payload,[f,p]=await(async()=>{if(c==="p256"){const{privateKey:d}=e;if(typeof d=="function")return[ot(jn({payload:a,privateKey:d()})),!1];if(d instanceof CryptoKey)return[ot(await ii({payload:a,privateKey:d})),!0]}if(c==="secp256k1")return[ot(Hn({payload:a,privateKey:i()})),!1];if(c==="webauthn-p256"){if(i.privateKey){const{payload:E,metadata:k}=ai({challenge:a,origin:"https://ithaca.xyz",rpId:"ithaca.xyz"}),{r:C,s:D}=jn({hash:!0,payload:E,privateKey:i.privateKey()});return[Wt({metadata:k,signature:{r:C,s:D}}),!1]}const{credential:d,rpId:l}=i,h=`porto.webauthnVerified.${e.hash}`,y=Date.now(),m=600*1e3;let g=!0;if(r){const E=await r.getItem(h);g=!E||y-E>m}const{signature:{r:b,s:w},raw:I,metadata:M}=await xr({challenge:a,credentialId:d.id,getFn:s?.getFn,rpId:l,userVerification:g?"required":"preferred"}),x=I.response;if(!x?.userHandle)throw new Error("No user handle in response",{cause:{response:x}});const v=rn(new Uint8Array(x.userHandle));if(e.id&&Mt(e.id)&&!N(e.id,v))throw new Error(`supplied webauthn key "${e.id}" does not match signature webauthn key "${v}"`,{cause:{id:v,key:e}});return g&&r&&await r.setItem(h,y),[Wt({metadata:M,signature:{r:b,s:w}}),!1]}throw new Error(`Key type "${c}" is not supported.

Key:
`+lt(e,null,2))})();return o?Sr(f,{keyType:c,prehash:p,publicKey:u}):f}function It(e,t={}){const{expiry:n=0,prehash:r=!1,publicKey:s,role:o="admin",type:i}=e,{feeTokens:u,orchestrator:c}=t,a=Object.entries(Nr(e,{feeTokens:u})).map(([f,p])=>{if(f==="calls")return p.map(({signature:l,to:h})=>({selector:l?sn(l)?l:Xr(l):Pn,to:h??Pr,type:"call"}));if(f!=="feeToken"){if(f==="spend")return p.map(({limit:l,period:h,token:y})=>({limit:l,period:h,token:y,type:"spend"}));throw new Error(`Invalid permission type "${f}".`)}}).flat().filter(Boolean);return e.role==="session"&&c&&a.push({selector:Pn,to:c,type:"call"}),{expiry:n,permissions:a??[],prehash:r,publicKey:Or(s),role:ki[o],type:vi[i]}}function Nr(e,t){const{permissions:n}=e,r=n?.calls?[...n.calls]:[],s=n?.spend?[...n.spend]:[],o=t.feeTokens?.filter(i=>i.feeToken);if(o&&o.length>0){const i=Pi(e,{feeTokens:o});if(i){let u=-1,c=zn.year;for(let a=0;a<s.length;a++){const f=s[a];if(f.token&&N(i.address,f.token)){u=a;break}if(!f.token&&i.address===_e){u=a;break}const p=zn[f.period];p<c&&(c=p)}u!==-1?(s[u]={...s[u],limit:s[u].limit+i.value},s.unshift(s.splice(u,1)[0])):typeof c=="number"&&s.unshift({limit:i.value,period:xi[c],token:i.address})}}return{...n,calls:r,spend:s}}function Pi(e,t){const{feeTokens:n}=t;if(!e.feeToken)return;const r=n.find(o=>e.feeToken.symbol===o.symbol?!0:e.feeToken.symbol?e.feeToken.symbol==="native"?o.address===_e:!1:o.address===_e);if(!r)return;const s=mr(e.feeToken.limit,r.decimals);return{...r,value:s}}function Wt(e){const{metadata:t,signature:n}=e;return xt(Jr(["struct WebAuthnAuth { bytes authenticatorData; string clientDataJSON; uint256 challengeIndex; uint256 typeIndex; bytes32 r; bytes32 s; }","WebAuthnAuth auth"]),[{authenticatorData:t.authenticatorData,challengeIndex:BigInt(t.challengeIndex),clientDataJSON:t.clientDataJSON,r:q(n.r,{size:32}),s:q(n.s,{size:32}),typeIndex:BigInt(t.typeIndex)}])}function Sr(e,t){const{keyType:n,prehash:r=!1,publicKey:s}=t,o=Cr({publicKey:s,type:n});return Zr(["bytes","bytes32","bool"],[e,o,r])}function B(e){const t=typeof e=="string"?{address:e}:e,n=t.sign?"privateKey":"porto",{address:r,sign:s,signMessage:o,signTransaction:i,signTypedData:u,type:c}=wi({address:t.address,sign({hash:a}){if(n==="privateKey")return t.sign({hash:a});throw new Error("`sign` not supported on porto accounts.")},signMessage({message:a}){return this.sign({hash:Ia(a)})},signTransaction(){throw new Error("`signTransaction` not supported on porto accounts.")},signTypedData(a){return this.sign({hash:wa(a)})}});return{address:r,keys:t.keys??void 0,sign:s,signMessage:o,signTransaction:i,signTypedData:u,source:n,type:c}}function zi(e,t={}){const{keys:n}=t,r=Qn(es({privateKey:e}));return B({address:r,keys:n,async sign({hash:s}){return ot(Hn({payload:s,privateKey:e}))},source:"privateKey"})}function Pt(e,t={}){const{key:n,role:r}=t;if(n!==null){if(typeof n=="object")return n;if(e.keys&&e.keys.length>0)return typeof n=="number"?e.keys[n]:e.keys.find(s=>s.privateKey&&(!r||s.role===r))}}async function Te(e,t){const{storage:n,replaySafe:r=!0,wrap:s=!0,webAuthn:o}=t,i=Pt(e,t),u=r?ln({domain:{verifyingContract:e.address},message:{digest:t.payload},primaryType:"ERC1271Sign",types:{ERC1271Sign:[{name:"digest",type:"bytes32"}]}}):t.payload,c=i?({hash:a})=>le(i,{address:null,payload:a,storage:n,webAuthn:o,wrap:s}):e.source==="privateKey"?e.sign:void 0;if(!c)throw new Error("cannot find key to sign with.");return await c({hash:u})}class Ci extends de{constructor(){super("Function is not recognized.",{metaMessages:["This could be due to any of the following:","  - The contract does not have the function,","  - The address is not a contract."],name:"FunctionSelectorNotRecognizedError"})}}function Oi(e,t){const n=e.walk(s=>"data"in s);if(!n?.data)return e;if(n.data===co(Tt("error FnSelectorNotRecognized()")))return new Ci;let r=null;for(const s of t.calls){const o=s;if(o.abi)try{if(!!!Cs({abi:o.abi,data:n.data}))continue;r=o}catch{}}return r?Os(n,{abi:r.abi,address:r.to,args:r.args,functionName:r.functionName}):e}async function Ni(e,t){try{const n="wallet_getAuthorization",r=await Dt(()=>e.request({method:n,params:[O(bn.Parameters,t)]}),{cacheKey:`${e.uid}.${n}.${t.address}`});return R(bn.Response,r)}catch(n){throw Q(n),n}}async function Ge(e,t={}){const n=(()=>{if(t.chainId)return[t.chainId];if(t.chainIds!=="all")return t.chainIds?t.chainIds:[e.chain.id]})();try{const r="wallet_getCapabilities",s=await Dt(()=>e.request({method:r,params:n?[n]:void 0},{retryCount:0}),{cacheKey:`${e.uid}.${r}.${n?.join(",")}`}),o=t.raw?s:R(Ns.Response,s);return t.chainIds?o:Object.values(o)[0]}catch(r){throw Q(r),r}}async function Si(e,t){const{account:n,assetFilter:r,assetTypeFilter:s,chainFilter:o}=t;try{const u=await e.request({method:"wallet_getAssets",params:[O(mn.Parameters,{account:n,assetFilter:r,assetTypeFilter:s,chainFilter:o})]}),c=R(mn.Response,u),a=Object.entries(c).reduce((p,[d,l])=>(p[Ne(d)]=l,p),{}),f={};for(const p of Object.values(a))for(const d of p){const l=JSON.stringify(d.metadata);f[l]={...d,balance:d.balance+(f[l]?.balance??0n)}}return{...a,0:Object.values(f)}}catch(i){throw Q(i),i}}async function _i(e,t){const{id:n}=t;try{const s=await e.request({method:"wallet_getCallsStatus",params:[n]});return R(Ss.Response,s)}catch(r){throw Q(r),r}}async function Ui(e,t){const{address:n,chainIds:r}=t;try{const o=await e.request({method:"wallet_getKeys",params:[O(xn.Parameters,{address:n,chainIds:r})]});return R(xn.Response,o)}catch(s){throw Q(s),s}}async function qi(e){const t="health",n=await Dt(()=>e.request({method:t}),{cacheKey:`${e.uid}.${t}`});return R(Us.Response,n)}async function Ct(e,t){const{address:n,capabilities:r,chain:s=e.chain,key:o}=t,i=t.calls.map(u=>({data:u.abi?ns(rs(u.abi,u.functionName),u.args):u.data??"0x",to:u.to,value:u.value??0n}));try{const c=await e.request({method:"wallet_prepareCalls",params:[O(Mn.Parameters,{calls:i,capabilities:{...r,meta:{...r?.meta}},chainId:s?.id,from:n,key:o?{prehash:o.prehash,publicKey:o.publicKey,type:o.type}:void 0})]},{retryCount:0});return Object.assign(R(Mn.Response,c),{_raw:c})}catch(u){throw Q(u),ke(u,{calls:t.calls}),u}}async function Ri(e,t){const{address:n,chain:r=e.chain,delegation:s,...o}=t;try{const u=await e.request({method:"wallet_prepareUpgradeAccount",params:[O(In.Parameters,Me({address:n,capabilities:o,chainId:r?.id,delegation:s}))]},{retryCount:0});return R(In.Response,u)}catch(i){throw Q(i),ke(i),i}}async function Li(e,t){const{capabilities:n,context:r,key:s,signature:o}=t;try{const u=await e.request({method:"wallet_sendPreparedCalls",params:[O(wn.Parameters,{capabilities:n,context:{preCall:r.preCall,quote:r.quote},key:s?{prehash:s.prehash,publicKey:s.publicKey,type:s.type}:void 0,signature:o})]},{retryCount:0});return R(wn.Response,u)}catch(i){throw Q(i),ke(i),i}}async function $i(e,t){const{email:n,walletAddress:r}=t;try{const o=await e.request({method:"account_setEmail",params:[O(vn.Parameters,{email:n,walletAddress:r})]},{retryCount:0});return R(vn.Response,o)}catch(s){throw Q(s),ke(s),s}}async function Ki(e,t){const{context:n,signatures:r}=t;try{await e.request({method:"wallet_upgradeAccount",params:[O(_s.Parameters,{context:n,signatures:r})]},{retryCount:0})}catch(s){throw Q(s),ke(s),s}}async function Fi(e,t){const{chainId:n,email:r,signature:s,token:o,walletAddress:i}=t;try{const c=await e.request({method:"account_verifyEmail",params:[O(gn.Parameters,{chainId:n,email:r,signature:s,token:o,walletAddress:i})]},{retryCount:0});return R(gn.Response,c)}catch(u){throw Q(u),ke(u),u}}async function Bi(e,t){const{signature:n}=t,{signature:r,capabilities:{feeSignature:s,...o},...i}=t.response,u=Gt({capabilities:o,...i}),c=F(X(JSON.stringify(u))),a=ss({payload:c,signature:as(n)}),{quoteSigner:f}=await qi(e);return a===f}async function Yi(e,t){const{address:n,chain:r=e.chain,digest:s,signature:o}=t;try{async function i(){return{proof:null,valid:await ts(e,{address:n,hash:s,signature:o})}}const u="wallet_verifySignature",c=await(async()=>{const a=await e.request({method:u,params:[O(yn.Parameters,{address:n,chainId:r?.id,digest:s,signature:o})]},{retryCount:0}).catch(i);return a.valid?a:i()})();return R(yn.Response,c)}catch(i){throw Q(i),i}}function ke(e,{calls:t}={}){if(!(e instanceof de))return;const n=o=>{try{if(o.name==="ContractFunctionExecutionError"){const a=o.cause.name==="ContractFunctionRevertedError"?o.cause.data:void 0;if(a)return io([a.abiItem],a.errorName)}const i=o.walk(a=>!(a instanceof Error)&&a.code===3);if(!i)return;const{data:u,message:c}=i;return u==="0xd0d5039b"?Tt("error Unauthorized()"):{inputs:[],name:(c??u).split("(")[0],type:"error"}}catch{return}},r=Oi(e,{calls:t??[]}),s=n(r);if(!(r===e&&!s))throw new Hi(Object.assign(r,{abiError:s}))}function Gt(e){if(typeof e=="object"&&e!==null){if(Array.isArray(e))return e.map(Gt);const t={};for(const n of Object.keys(e).sort())t[n]=Gt(e[n]);return t}return e}function Q(e){if(e.name==="$ZodError")throw er(e)}class Hi extends J{constructor(t){super("An error occurred while executing calls.",{cause:t,metaMessages:[t.abiError&&"Reason: "+t.abiError.name].filter(Boolean)}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Rpc.ExecutionError"}),Object.defineProperty(this,"abiError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiError=t.abiError}}const Qi={prod:{http:"https://rpc.porto.sh"}};function Ve(e){return t=>{const n=e.public(t),r=e.relay(t);return qs({key:Ve.type,name:"Relay Proxy",async request({method:s,params:o},i){return Wi(s)?r.request({method:s,params:o},i):n.request({method:s,params:o},i)},type:Ve.type})}}(function(e){e.type="relayProxy"})(Ve||(Ve={}));function Wi(e){return!!(e.startsWith("wallet_")||e.startsWith("account_")||e==="health")}const Ot=new Map;function Gi(e,t={}){const{config:n,id:r,store:s}=e._internal,{chains:o,relay:i}=n,u=s.getState(),c=t.chainId??u.chainIds[0],a=o.find(l=>l.id===c);if(!a)throw new Error(["Could not find a compatible Porto chain on the given chain configuration.","",`Provided chains: [${o.map(l=>`${l.name} (id: ${l.id})`).join(", ")}]`,`Needed chain (id): ${c}`,"Please add this chain (id) to your chain configuration."].join(`
`));const f=Ve({public:n.transports[a.id]??Rs(a.rpcUrls.default.http.map(l=>At(l))),relay:i}),p=[r,lt(a)].filter(Boolean).join(":");if(Ot.has(p))return Ot.get(p);const d=tr({...t,chain:a,pollingInterval:1e3,transport:f});return Ot.set(p,d),d}const Vt=Ls;function _r(e,t){const{chainId:n,expiry:r,permissions:s,id:o,publicKey:i,type:u}=e,{address:c}=t;return{address:c,chainId:n,expiry:r,id:o,key:{publicKey:i,type:u},permissions:s??{}}}function Nn(e){const{chainId:t,expiry:n,key:r}=e;return G({chainId:t,expiry:n,permissions:e.permissions??{},publicKey:r.publicKey,role:"session",type:r.type})}const Sn=Ks("method",[Fs.Request,Bs.Request,Ys.Request,Hs.Request,Qs.Request,Ws.Request,Gs.Request,Vs.Request,on.Request,Zs.Request,nr.Request,rr.Request,Js.Request,Xs.Request,ea.Request,ta.Request,na.Request,ra.Request,sa.Request,aa.Request,cn.Request,oa.Request,ia.Request,ft.Request,pt.Request,ca.Request,ua.Request,da.Request,la.Request]);function _n(e,t){const n=$s(e,t);if(n.error){const r=n.error.issues.at(0);throw r?.code==="invalid_union"&&r.note==="No matching discriminator"?new pe:new he(er(n.error))}return{...t,_decoded:n.data}}async function Un(e){e.persist.hasHydrated()||await new Promise(t=>{e.persist.onFinishHydration(()=>t(!0)),setTimeout(()=>t(!0),100)})}function Nt(e){if(e)return e.startsWith("/")?`${window.location.origin}${e}`:e}function Vi(e){const{config:t,getMode:n,id:r,store:s}=e,{announceProvider:o}=t;function i(h={}){const y=u(),m=h.request??_n(Sn,{method:"wallet_getCapabilities",params:h.chainIds?[void 0,h.chainIds]:void 0});return Dt(()=>n().actions.getCapabilities({chainIds:h.chainIds,internal:{client:y,config:t,request:m,store:s}}),{cacheKey:`getCapabilities.${r}.${h.chainIds?.join(",")}`})}function u(h){const y=typeof h=="string"?Ne(h):h;return Gi({_internal:e},{chainId:y})}const c=new Map,a=[],f=jo(),p=hr({...f,async request(h){await Un(s);let y;try{y=_n(Sn,h)}catch(g){const b=g;if(!(b instanceof pe))throw b;if(h.method.startsWith("wallet_"))throw new Qe;return u().request(h)}const m=s.getState();switch(y.method){case"account_verifyEmail":{if(m.accounts.length===0)throw new U;const[g]=y._decoded.params,{chainId:b,email:w,token:I,walletAddress:M}=g,x=u(b);if(b&&b!==x.chain.id)throw new se;const v=M?m.accounts.find(j=>N(j.address,M)):m.accounts[0];if(!v)throw new _;return await n().actions.verifyEmail({account:v,chainId:b,email:w,internal:{client:x,config:t,request:y,store:s},token:I,walletAddress:M})}case"wallet_addFunds":{if(m.accounts.length===0)throw new U;const{address:g,value:b,token:w}=y.params[0]??{},I=g?m.accounts.find(v=>N(v.address,g)):m.accounts[0];if(!I)throw new _;const M=u(),x=await n().actions.addFunds({address:I.address,internal:{client:M,config:t,request:y,store:s},token:w,value:b});return f.emit("message",{data:null,type:"assetsChanged"}),x}case"eth_accounts":{if(m.accounts.length===0)throw new U;return m.accounts.map(g=>g.address)}case"eth_chainId":return q(m.chainIds[0]);case"eth_requestAccounts":{if(m.accounts.length>0&&c.get("eth_requestAccounts"))return m.accounts.map(w=>w.address);const g=u(),{accounts:b}=await n().actions.loadAccounts({internal:{client:g,config:t,request:y,store:s}});return s.setState(w=>({...w,accounts:b})),f.emit("connect",{chainId:q(g.chain.id)}),c.set("eth_requestAccounts",!0),setTimeout(()=>c.delete("eth_requestAccounts"),1e3),b.map(w=>w.address)}case"eth_sendTransaction":{if(m.accounts.length===0)throw new U;const[{capabilities:g,chainId:b,data:w="0x",from:I,to:M,value:x}]=y._decoded.params,v=u(b);if(b&&b!==v.chain.id)throw new se;const j=I?m.accounts.find(k=>N(k.address,I)):m.accounts[0];if(!j)throw new _;const{id:E}=await n().actions.sendCalls({account:j,asTxHash:!0,calls:[{data:w,to:M,value:x}],internal:{client:v,config:t,request:y,store:s},merchantUrl:Nt(t.merchantUrl??g?.merchantUrl)});return E}case"eth_signTypedData_v4":{if(m.accounts.length===0)throw new U;const[g,b]=y._decoded.params,w=m.accounts.find(x=>N(x.address,g));if(!w)throw new _;const I=u();return await n().actions.signTypedData({account:w,data:b,internal:{client:I,config:t,request:y,store:s}})}case"wallet_grantAdmin":{if(m.accounts.length===0)throw new U;const[{address:g,capabilities:b,chainId:w,key:I}]=y._decoded.params??[{}],M=g?m.accounts.find(k=>N(k.address,g)):m.accounts[0];if(!M)throw new _;const x=u(w);if(Pe([...M.keys??[]])?.some(k=>k.publicKey?.toLowerCase()===I.publicKey.toLowerCase()))throw new he({message:"Key already granted as admin."});const{key:j}=await n().actions.grantAdmin({account:M,feeToken:b?.feeToken,internal:{client:x,config:t,request:y,store:s},key:I});s.setState(k=>{const C=k.accounts.findIndex(D=>M?N(D.address,M.address):!0);return C===-1?k:{...k,accounts:k.accounts.map((D,T)=>T===C?{...D,keys:[...D.keys??[],j]}:D)}});const E=Pe([...M.keys??[],j]);return f.emit("message",{data:null,type:"adminsChanged"}),O(nr.Response,{address:M.address,chainId:x.chain.id,key:E.at(-1)})}case"wallet_grantPermissions":{if(m.accounts.length===0)throw new U;const[{address:g,chainId:b,...w}]=y._decoded.params??[{}],I=g?m.accounts.find(v=>N(v.address,g)):m.accounts[0];if(!I)throw new _;const M=u(b),{key:x}=await n().actions.grantPermissions({account:I,internal:{client:M,config:t,request:y,store:s},permissions:w});return s.setState(v=>{const j=v.accounts.findIndex(E=>I?N(E.address,I.address):!0);return j===-1?v:{...v,accounts:v.accounts.map((E,k)=>k===j?{...E,keys:[...E.keys??[],x]}:E)}}),f.emit("message",{data:null,type:"permissionsChanged"}),O(rr.Response,{..._r(x,{address:I.address})})}case"wallet_getAdmins":{if(m.accounts.length===0)throw new U;const[{address:g,chainId:b}]=y._decoded.params??[{}],w=g?m.accounts.find(v=>N(v.address,g)):m.accounts[0];if(!w)throw new _;const I=u(b),M=await n().actions.getKeys({account:w,internal:{client:I,config:t,request:y,store:s}}),x=Pe(M);return O(on.Response,{address:w.address,chainId:I.chain.id,keys:x})}case"wallet_prepareUpgradeAccount":{const[{address:g,capabilities:b,chainId:w}]=y._decoded.params??[{}],{email:I,label:M,grantPermissions:x}=b??{},v=u(w),{context:j,digests:E}=await n().actions.prepareUpgradeAccount({address:g,email:I,internal:{client:v,config:t,request:y,store:s},label:M,permissions:x});return a.push(j.account),{context:j,digests:E}}case"wallet_getAccountVersion":{if(m.accounts.length===0)throw new U;const[{address:g}]=y._decoded.params??[{}],b=g?m.accounts.find(x=>N(x.address,g)):m.accounts[0];if(!b)throw new _;const w=u(),{current:I,latest:M}=await n().actions.getAccountVersion({address:b.address,internal:{client:w,config:t,request:y,store:s}});return{current:I,latest:M}}case"wallet_getKeys":{if(m.accounts.length===0)throw new U;const[{address:g,chainIds:b}]=y._decoded.params??[{}],w=m.accounts.find(x=>N(x.address,g));if(!w)throw new _;const I=u(),M=await n().actions.getKeys({account:w,chainIds:b,internal:{client:I,config:t,request:y,store:s}});return O(ft.Response,M)}case"wallet_getPermissions":{if(m.accounts.length===0)throw new U;const[{address:g,chainIds:b}]=y._decoded.params??[{}],w=g?m.accounts.find(v=>N(v.address,g)):m.accounts[0];if(!w)throw new _;const I=u(),M=await n().actions.getKeys({account:w,chainIds:b,internal:{client:I,config:t,request:y,store:s}});return St(M,{address:w.address})}case"wallet_revokeAdmin":{if(m.accounts.length===0)throw new U;const[{address:g,capabilities:b,id:w}]=y._decoded.params,I=g?m.accounts.find(v=>N(v.address,g)):m.accounts[0];if(!I)throw new _;const M=u();await n().actions.revokeAdmin({account:I,feeToken:b?.feeToken,id:w,internal:{client:M,config:t,request:y,store:s}});const x=I.keys?.filter(v=>v.id.toLowerCase()!==w.toLowerCase());s.setState(v=>({...v,accounts:v.accounts.map(j=>N(j.address,I.address)?{...j,keys:x}:j)})),f.emit("message",{data:null,type:"adminsChanged"});return}case"wallet_revokePermissions":{if(m.accounts.length===0)throw new U;const[{address:g,capabilities:b,id:w}]=y._decoded.params,I=g?m.accounts.find(v=>N(v.address,g)):m.accounts[0];if(!I)throw new _;const M=u();await n().actions.revokePermissions({account:I,feeToken:b?.feeToken,id:w,internal:{client:M,config:t,request:y,store:s}});const x=I.keys?.filter(v=>v.id.toLowerCase()!==w.toLowerCase());s.setState(v=>({...v,accounts:v.accounts.map(j=>N(j.address,I.address)?{...j,keys:x}:j)})),f.emit("message",{data:null,type:"permissionsChanged"});return}case"wallet_upgradeAccount":{const[{context:g,signatures:b}]=y._decoded.params??[{}],w=u(),I=a.find(j=>N(j.address,g.account.address));if(!I)throw new _;const{account:M}=await n().actions.upgradeAccount({account:I,context:g,internal:{client:w,config:t,request:y,store:s},signatures:b}),x=Pe(M.keys??[]),v=St(M.keys??[],{address:M.address});return s.setState(j=>({...j,accounts:[M]})),f.emit("connect",{chainId:q(w.chain.id)}),{address:M.address,capabilities:{admins:x,...v.length>0?{permissions:v}:{}}}}case"porto_ping":return"pong";case"personal_sign":{if(m.accounts.length===0)throw new U;const[g,b]=y._decoded.params,w=m.accounts.find(x=>N(x.address,b));if(!w)throw new _;const I=u();return await n().actions.signPersonalMessage({account:w,data:g,internal:{client:I,config:t,request:y,store:s}})}case"wallet_connect":{const[{capabilities:g,chainIds:b}]=y._decoded.params??[{}],w=u(b?.[0]),I=w.chain.id,{createAccount:M,email:x,grantAdmins:v,grantPermissions:j,selectAccount:E,signInWithEthereum:k}=g??{},C={client:w,config:t,request:y,store:s},{accounts:D}=await(async()=>{if(x||M){const{label:S=void 0}=typeof M=="object"?M:{},{account:ye}=await n().actions.createAccount({admins:v,email:x,internal:C,label:S,permissions:j,signInWithEthereum:k});return{accounts:[ye]}}const A=m.accounts[0],{address:z,key:K}=(()=>{if(E)return typeof E=="object"?E:{address:void 0,key:void 0};for(const S of A?.keys??[])if(S.type==="webauthn-p256"&&S.role==="admin")return{address:A?.address,key:{credentialId:S.credentialId??S.privateKey?.credential?.id,publicKey:S.publicKey}};return{address:void 0,key:void 0}})(),L={internal:C,permissions:j,signInWithEthereum:k};try{return await n().actions.loadAccounts({address:z,key:K,...L})}catch(S){if(S instanceof Ie)throw S;if(z&&K)return await n().actions.loadAccounts(L);throw S}})();s.setState(A=>({...A,accounts:D}));const T=[I,...s.getState().chainIds.filter(A=>A!==I)];return f.emit("connect",{chainId:q(T[0])}),{accounts:D.map(A=>({address:A.address,capabilities:{admins:A.keys?Pe(A.keys):[],permissions:A.keys?St(A.keys,{address:A.address}):[],...A.signInWithEthereum&&{signInWithEthereum:A.signInWithEthereum}}})),chainIds:T.map(A=>q(A))}}case"wallet_disconnect":{const g=u();await n().actions.disconnect?.({internal:{client:g,config:t,request:y,store:s}}),s.setState(b=>({...b,accounts:[]})),f.emit("disconnect",new U);return}case"wallet_getAssets":{const[g]=y._decoded.params??[],{account:b,chainFilter:w,assetFilter:I,assetTypeFilter:M}=g,x=u(),v=await n().actions.getAssets({account:b,assetFilter:I,assetTypeFilter:M,chainFilter:w,internal:{client:x,config:t,request:y,store:s}}),j=Object.entries(v).reduce((E,[k,C])=>(E[q(Number(k))]=C,E),{});return O(cn.Response,j)}case"wallet_getCallsStatus":{const[g]=y._decoded.params??[],b=u();return await n().actions.getCallsStatus({id:g,internal:{client:b,config:t,request:y,store:s}})}case"wallet_getCapabilities":{const[g,b]=y.params??[];return await i({chainIds:b,request:y})}case"wallet_prepareCalls":{const[g]=y._decoded.params,{calls:b,capabilities:w,chainId:I,key:M,from:x}=g,v=u(I),j=x??m.accounts[0];if(!j)throw new _;if(I&&I!==v.chain.id)throw new se;const{digest:E,...k}=await n().actions.prepareCalls({account:B(j),calls:b,feeToken:w?.feeToken,internal:{client:v,config:t,request:y,store:s},key:M,merchantUrl:Nt(t.merchantUrl??w?.merchantUrl),requiredFunds:w?.requiredFunds});return O(pt.Response,{capabilities:k.capabilities,chainId:q(k.chainId??v.chain.id),context:{...k.context,account:{address:k.account.address},calls:k.context.calls??[],nonce:k.context.nonce??0n},digest:E,key:k.key,typedData:k.typedData})}case"wallet_sendPreparedCalls":{const[g]=y._decoded.params,{chainId:b,context:w,key:I,signature:M}=g,{account:x}=g.context,v=u(b);if(b&&Ne(b)!==v.chain.id)throw new se;return[{id:await n().actions.sendPreparedCalls({account:B(x),context:w,internal:{client:v,config:t,request:y,store:s},key:I,signature:M})}]}case"wallet_sendCalls":{if(m.accounts.length===0)throw new U;const[g]=y._decoded.params,{calls:b,capabilities:w,chainId:I,from:M}=g,x=u(I);if(I&&I!==x.chain.id)throw new se;const v=M?m.accounts.find(E=>N(E.address,M)):m.accounts[0];if(!v)throw new _;const{id:j}=await n().actions.sendCalls({account:v,calls:b,feeToken:w?.feeToken,internal:{client:x,config:t,request:y,store:s},merchantUrl:Nt(t.merchantUrl??w?.merchantUrl),permissionsId:w?.permissions?.id,requiredFunds:w?.requiredFunds});return{id:j}}case"wallet_switchEthereumChain":{const[g]=y._decoded.params,{chainId:b}=g,w=Ne(b);if(!t.chains.find(x=>x.id===w))throw new mt;const M=u(b);await n().actions.switchChain?.({chainId:M.chain.id,internal:{client:M,config:t,request:y,store:s}}),s.setState(x=>({...x,chainIds:[w,...x.chainIds.filter(v=>v!==w)]}));return}case"wallet_verifySignature":{const[g]=y._decoded.params,{address:b,chainId:w,digest:I,signature:M}=g,x=u(w);return{...await Yi(x,{address:b,digest:I,signature:M}),address:b,chainId:q(x.chain.id)}}}}});function d(){let h=()=>{},y=()=>{};Un(s).then(()=>{i().catch(()=>{}),h(),h=s.subscribe(g=>g.accounts,g=>{f.emit("accountsChanged",g.map(b=>b.address))},{equalityFn:(g,b)=>g.every((w,I)=>w.address===b[I]?.address)}),y(),y=s.subscribe(g=>g.chainIds[0],(g,b)=>{g!==b&&f.emit("chainChanged",q(g))})});const m=Zi(p,o);return()=>{h(),y(),m()}}const l=d();return Object.assign(p,{_internal:{destroy:l}})}function Zi(e,t){if(!t)return()=>{};if(typeof window>"u"||!window.dispatchEvent)return()=>{};const{icon:n="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDIyIiBoZWlnaHQ9IjQyMiIgdmlld0JveD0iMCAwIDQyMiA0MjIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MjIiIGhlaWdodD0iNDIyIiBmaWxsPSJibGFjayIvPgo8ZyBjbGlwLXBhdGg9InVybCgjY2xpcDBfMV8xNSkiPgo8cGF0aCBkPSJNODEgMjg2LjM2NkM4MSAyODAuODkzIDg1LjQ1MDUgMjc2LjQ1NSA5MC45NDA0IDI3Ni40NTVIMzI5LjUxMUMzMzUuMDAxIDI3Ni40NTUgMzM5LjQ1MiAyODAuODkzIDMzOS40NTIgMjg2LjM2NlYzMDYuMTg4QzMzOS40NTIgMzExLjY2MiAzMzUuMDAxIDMxNi4wOTkgMzI5LjUxMSAzMTYuMDk5SDkwLjk0MDRDODUuNDUwNSAzMTYuMDk5IDgxIDMxMS42NjIgODEgMzA2LjE4OFYyODYuMzY2WiIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC41Ii8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOTAuOTQwNCAyMzQuODI4Qzg1LjQ1MDUgMjM0LjgyOCA4MSAyMzkuMjY2IDgxIDI0NC43MzlWMjcxLjUzMUM4My44NDMyIDI2OS42MzMgODcuMjYyMiAyNjguNTI2IDkwLjk0MDQgMjY4LjUyNkgzMjkuNTExQzMzMy4xODggMjY4LjUyNiAzMzYuNjA4IDI2OS42MzMgMzM5LjQ1MiAyNzEuNTMxVjI0NC43MzlDMzM5LjQ1MiAyMzkuMjY2IDMzNS4wMDEgMjM0LjgyOCAzMjkuNTExIDIzNC44MjhIOTAuOTQwNFpNMzM5LjQ1MiAyODYuMzY2QzMzOS40NTIgMjgwLjg5MyAzMzUuMDAxIDI3Ni40NTUgMzI5LjUxMSAyNzYuNDU1SDkwLjk0MDRDODUuNDUwNSAyNzYuNDU1IDgxIDI4MC44OTMgODEgMjg2LjM2NlYzMDYuMTlDODEgMzExLjY2NCA4NS40NTA1IDMxNi4xMDEgOTAuOTQwNCAzMTYuMTAxSDMyOS41MTFDMzM1LjAwMSAzMTYuMTAxIDMzOS40NTIgMzExLjY2NCAzMzkuNDUyIDMwNi4xOVYyODYuMzY2WiIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC41Ii8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOTAuOTQwNCAxOTMuMjAxQzg1LjQ1MDUgMTkzLjIwMSA4MSAxOTcuNjM4IDgxIDIwMy4xMTJWMjI5LjkwM0M4My44NDMyIDIyOC4wMDYgODcuMjYyMiAyMjYuODk5IDkwLjk0MDQgMjI2Ljg5OUgzMjkuNTExQzMzMy4xODggMjI2Ljg5OSAzMzYuNjA4IDIyOC4wMDYgMzM5LjQ1MiAyMjkuOTAzVjIwMy4xMTJDMzM5LjQ1MiAxOTcuNjM4IDMzNS4wMDEgMTkzLjIwMSAzMjkuNTExIDE5My4yMDFIOTAuOTQwNFpNMzM5LjQ1MiAyNDQuNzM5QzMzOS40NTIgMjM5LjI2NSAzMzUuMDAxIDIzNC44MjggMzI5LjUxMSAyMzQuODI4SDkwLjk0MDRDODUuNDUwNSAyMzQuODI4IDgxIDIzOS4yNjUgODEgMjQ0LjczOVYyNzEuNTNDODEuMjE3NSAyNzEuMzg1IDgxLjQzODMgMjcxLjI0NSA4MS42NjI0IDI3MS4xMDlDODMuODMyNSAyNjkuNzk0IDg2LjMwNTQgMjY4LjkyNyA4OC45NTIzIDI2OC42MzVDODkuNjA1MSAyNjguNTYzIDkwLjI2ODQgMjY4LjUyNiA5MC45NDA0IDI2OC41MjZIMzI5LjUxMUMzMzAuMTgzIDI2OC41MjYgMzMwLjg0NiAyNjguNTYzIDMzMS40OTggMjY4LjYzNUMzMzQuNDE5IDI2OC45NTcgMzM3LjEyOCAyNjkuOTggMzM5LjQ1MiAyNzEuNTNWMjQ0LjczOVpNMzM5LjQ1MiAyODYuMzY2QzMzOS40NTIgMjgxLjAyMSAzMzUuMjA2IDI3Ni42NjMgMzI5Ljg5MyAyNzYuNDYyQzMyOS43NjcgMjc2LjQ1NyAzMjkuNjQgMjc2LjQ1NSAzMjkuNTExIDI3Ni40NTVIOTAuOTQwNEM4NS40NTA1IDI3Ni40NTUgODEgMjgwLjg5MyA4MSAyODYuMzY2VjMwNi4xODhDODEgMzExLjY2MiA4NS40NTA1IDMxNi4xMDEgOTAuOTQwNCAzMTYuMTAxSDMyOS41MTFDMzM1LjAwMSAzMTYuMTAxIDMzOS40NTIgMzExLjY2MiAzMzkuNDUyIDMwNi4xODhWMjg2LjM2NloiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuNSIvPgo8cGF0aCBvcGFjaXR5PSIwLjMiIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOTguMDE0NiAxMDRDODguNjE3NyAxMDQgODEgMTExLjU5NSA4MSAxMjAuOTY1VjE4OC4yNzZDODMuODQzMiAxODYuMzc5IDg3LjI2MjIgMTg1LjI3MiA5MC45NDA0IDE4NS4yNzJIMzI5LjUxMUMzMzMuMTg4IDE4NS4yNzIgMzM2LjYwOCAxODYuMzc5IDMzOS40NTIgMTg4LjI3NlYxMjAuOTY1QzMzOS40NTIgMTExLjU5NSAzMzEuODMzIDEwNCAzMjIuNDM3IDEwNEg5OC4wMTQ2Wk0zMzkuNDUyIDIwMy4xMTJDMzM5LjQ1MiAxOTcuNjM4IDMzNS4wMDEgMTkzLjIwMSAzMjkuNTExIDE5My4yMDFIOTAuOTQwNEM4NS40NTA1IDE5My4yMDEgODEgMTk3LjYzOCA4MSAyMDMuMTEyVjIyOS45MDNDODEuMjE3NSAyMjkuNzU4IDgxLjQzODMgMjI5LjYxOCA4MS42NjI0IDIyOS40ODJDODMuODMyNSAyMjguMTY3IDg2LjMwNTQgMjI3LjMgODguOTUyMyAyMjcuMDA4Qzg5LjYwNTEgMjI2LjkzNiA5MC4yNjg0IDIyNi44OTkgOTAuOTQwNCAyMjYuODk5SDMyOS41MTFDMzMwLjE4MyAyMjYuODk5IDMzMC44NDYgMjI2LjkzNiAzMzEuNDk4IDIyNy4wMDhDMzM0LjQxOSAyMjcuMzMgMzM3LjEyOCAyMjguMzUyIDMzOS40NTIgMjI5LjkwM1YyMDMuMTEyWk0zMzkuNDUyIDI0NC43MzlDMzM5LjQ1MiAyMzkuMzkzIDMzNS4yMDYgMjM1LjAzNiAzMjkuODkzIDIzNC44MzVDMzI5Ljc2NyAyMzQuODMgMzI5LjY0IDIzNC44MjggMzI5LjUxMSAyMzQuODI4SDkwLjk0MDRDODUuNDUwNSAyMzQuODI4IDgxIDIzOS4yNjUgODEgMjQ0LjczOVYyNzEuNTNMODEuMDcwNyAyNzEuNDgzQzgxLjI2NTMgMjcxLjM1NSA4MS40NjI1IDI3MS4yMyA4MS42NjI0IDI3MS4xMDlDODEuOTA4MyAyNzAuOTYgODIuMTU4MSAyNzAuODE3IDgyLjQxMTcgMjcwLjY3OUM4NC4zOTUzIDI2OS42MDUgODYuNjA1NCAyNjguODk0IDg4Ljk1MjMgMjY4LjYzNUM4OS4wMDUyIDI2OC42MjkgODkuMDU4IDI2OC42MjQgODkuMTExIDI2OC42MThDODkuNzEyNSAyNjguNTU3IDkwLjMyMjggMjY4LjUyNiA5MC45NDA0IDI2OC41MjZIMzI5LjUxMUMzMjkuNzM4IDI2OC41MjYgMzI5Ljk2NSAyNjguNTMgMzMwLjE5MiAyNjguNTM5QzMzMC42MzEgMjY4LjU1NSAzMzEuMDY3IDI2OC41ODcgMzMxLjQ5OCAyNjguNjM1QzMzNC40MTkgMjY4Ljk1NyAzMzcuMTI4IDI2OS45OCAzMzkuNDUyIDI3MS41M1YyNDQuNzM5Wk0zMzkuNDUyIDI4Ni4zNjZDMzM5LjQ1MiAyODEuMDIxIDMzNS4yMDYgMjc2LjY2MyAzMjkuODkzIDI3Ni40NjJMMzI5Ljg2NSAyNzYuNDYxQzMyOS43NDggMjc2LjQ1NyAzMjkuNjI5IDI3Ni40NTUgMzI5LjUxMSAyNzYuNDU1SDkwLjk0MDRDODUuNDUwNSAyNzYuNDU1IDgxIDI4MC44OTMgODEgMjg2LjM2NlYzMDYuMTg4QzgxIDMxMS42NjIgODUuNDUwNSAzMTYuMTAxIDkwLjk0MDQgMzE2LjEwMUgzMjkuNTExQzMzNS4wMDEgMzE2LjEwMSAzMzkuNDUyIDMxMS42NjIgMzM5LjQ1MiAzMDYuMTg4VjI4Ni4zNjZaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMjY5Ljg2OCAxMzEuNzUyQzI2OS44NjggMTI2LjI3OCAyNzQuMzE4IDEyMS44NCAyNzkuODA4IDEyMS44NEgzMTEuNjE4QzMxNy4xMDggMTIxLjg0IDMyMS41NTggMTI2LjI3OCAzMjEuNTU4IDEzMS43NTJWMTYxLjQ4NUMzMjEuNTU4IDE2Ni45NTkgMzE3LjEwOCAxNzEuMzk2IDMxMS42MTggMTcxLjM5NkgyNzkuODA4QzI3NC4zMTggMTcxLjM5NiAyNjkuODY4IDE2Ni45NTkgMjY5Ljg2OCAxNjEuNDg1VjEzMS43NTJaIiBmaWxsPSJ3aGl0ZSIvPgo8L2c+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzFfMTUiPgo8cmVjdCB3aWR0aD0iMjU5IiBoZWlnaHQ9IjIxMyIgZmlsbD0id2hpdGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDgxIDEwNCkiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K",name:r="Porto",rdns:s="xyz.ithaca.porto"}=typeof t=="object"?t:{};return fa({info:{icon:n,name:r,rdns:s,uuid:fn()},provider:e})}function Pe(e){return e.map(t=>{if(t.role==="admin")try{return O(on.Key,{id:t.id??t.publicKey,publicKey:t.publicKey,type:t.type,...t.type==="webauthn-p256"?{credentialId:t.privateKey?.credential?.id,privateKey:{credential:{id:t.privateKey?.credential?.id},rpId:t.privateKey?.rpId}}:{}})}catch{return}}).filter(Boolean)}function St(e,{address:t}){return e.map(n=>{if(n.chainId&&n.role==="session"&&!(n.expiry>0&&n.expiry<BigInt(Math.floor(Date.now()/1e3))))try{return O(Vt,_r(n,{address:t}))}catch{return}}).filter(Boolean)}function Ur(e){return{...e,setup:e.setup??(()=>()=>{})}}async function Zt(e){const{account:t,calls:n,permissionsId:r}=e;if(typeof r<"u"){if(r===null)return;const i=t.keys?.find(u=>u.publicKey===r&&u.privateKey);if(!i)throw new Error(`permission (id: ${r}) does not exist.`);return i}const s=t.keys?.find(i=>!i.privateKey||i.role!=="session"||i.expiry<BigInt(Math.floor(Date.now()/1e3))?!1:!!n.every(c=>i.permissions?.calls?.some(a=>{if(a.to&&a.to!==c.to)return!1;if(a.signature){if(!c.data)return!1;const f=Ue(c.data,0,4);if(sn(a.signature))return a.signature===f;if(Bn(a.signature)!==f)return!1}return!0}))),o=t.keys?.find(i=>i.role==="admin"&&i.privateKey);return s??o}const nt=pa;function rt(e){const{expiry:t,feeToken:n,permissions:r,publicKey:s,type:o}=e;return{expiry:t,feeToken:n??null,key:{publicKey:s,type:o},permissions:r??{}}}async function oe(e,t={}){if(!e)return;const n=t.chainId??e.chainId,r=e.expiry??0,s=e.key?.type??"secp256k1",o=e.feeToken,i=Nr(e,{feeTokens:t.feeTokens}),u=e?.key?.publicKey??"0x",c=G({chainId:n,expiry:r,feeToken:o,permissions:i,publicKey:u,role:"session",type:s});return e?.key?c:await ji({...c,role:"session"})}async function qn(e){const{address:t,authUrl:n,message:r,signature:s}=e,{chainId:o}=Ro(r);return await fetch(n.verify,{body:JSON.stringify({address:t,chainId:o,message:r,signature:s,walletAddress:t}),credentials:"include",headers:{"Content-Type":"application/json"},method:"POST"}).then(i=>i.json())}async function _t(e,t,n){const{chainId:r=e.chain?.id,domain:s,uri:o,resources:i,version:u="1"}=t,{address:c}=n,a=t.authUrl?qr(t.authUrl):void 0;if(!r)throw new Error("`chainId` is required.");if(!s)throw new Error("`domain` is required.");if(!t.nonce&&!a?.nonce)throw new Error("`nonce` or `authUrl.nonce` is required.");if(!o)throw new Error("`uri` is required.");const f=await(async()=>{if(t.nonce)return t.nonce;if(!a?.nonce)throw new Error("`nonce` or `authUrl.nonce` is required.");const l=await(await fetch(a.nonce,{body:JSON.stringify({address:c,chainId:r,walletAddress:c}),headers:{"Content-Type":"application/json"},method:"POST"})).json().catch(()=>{});if(!l?.nonce)throw new Error("`nonce` or `authUrl.nonce` is required.");return l.nonce})();return Uo({...t,address:n.address,chainId:r,domain:s,nonce:f,resources:i,uri:o,version:u})}function qr(e,t=""){if(!e)return;const n=(()=>{if(typeof e=="string"){const r=e.replace(/\/$/,"");return{logout:r+"/logout",nonce:r+"/nonce",verify:r+"/verify"}}return e})();return{logout:Ut(n.logout,t),nonce:Ut(n.nonce,t),verify:Ut(n.verify,t)}}function Ut(e,t){return!t||!e.startsWith("/")?e:t+e}async function Rn(e,t){const{account:n=e.account}=t,r=n?B(n):void 0;if(!r)throw new Error("account is required.");const{domain:{name:s,version:o}}=await os(e,{address:r.address});if(!e.chain)throw new Error("client.chain is required");return{chainId:e.chain.id,name:s,verifyingContract:r.address,version:o}}async function Ln(e,t){const{account:n=e.account,chainIds:r}=t,s=n?B(n):void 0;if(!s)throw new Error("account is required.");const o=await Ui(e,{address:s.address,chainIds:r});return Object.entries(o).flatMap(([i,u])=>u.map(c=>Di(c,{chainId:Number(i)})))}async function Se(e,t){const{account:n=e.account,calls:r,chain:s=e.chain,feePayer:o,merchantUrl:i,nonce:u,preCalls:c,requiredFunds:a,revokeKeys:f}=t,p=n?B(n):void 0,d=t.key??(p?Pt(p,{role:"admin"}):void 0),l=t.authorizeKeys?.some(D=>D.role==="session"),{contracts:h,fees:{tokens:y}}=await Ge(e,{chainId:s?.id}),m=l?h.orchestrator.address:void 0,g=(t.authorizeKeys??[]).map(D=>It(D,{feeTokens:y,orchestrator:m})),b=t.feeToken?t.feeToken:d?.permissions?.spend?.[0]?.token,w=typeof c=="boolean"?c:!1,I=typeof c=="object"?c.map(({context:D,signature:T})=>({...D.preCall,signature:T})):void 0,M={address:p?.address,calls:r??[],capabilities:{authorizeKeys:g,meta:{feePayer:o,feeToken:b,nonce:u},preCall:w,preCalls:I,requiredFunds:a,revokeKeys:f?.map(D=>({hash:D.hash}))},chain:s,key:d?It(d,{feeTokens:y}):void 0},x=await(async()=>{if(i){const D=tr({chain:e.chain,transport:At(i)});return await Ct(D,M).catch(T=>(console.error(T),Ct(e,M)))}return await Ct(e,M)})(),{capabilities:v,context:j,digest:E,signature:k,typedData:C}=x;if(i&&!await Bi(e,{response:x._raw,signature:k}))throw new Error(`cannot verify integrity of \`wallet_prepareCalls\` response from ${i}`);return{capabilities:{...v,quote:j.quote},context:j,digest:E,key:d,typedData:C}}async function Rr(e,t){const{address:n,authorizeKeys:r,chain:s=e.chain}=t;if(!s)throw new Error("chain is required.");const{contracts:o,fees:{tokens:i}}=await Ge(e,{chainId:s.id}),u=t.delegation??o.accountProxy.address,a=r.some(g=>g.role==="session")?o.orchestrator.address:void 0,f=r.map(g=>{const b=g.role==="session"?g.permissions:{};return It({...g,permissions:b},{feeTokens:i,orchestrator:a})}),{capabilities:p,chainId:d,context:l,digests:h,typedData:y}=await Ri(e,{address:n,authorizeKeys:f,chain:s,delegation:u}),m=B({address:n,keys:r});return{capabilities:p,chainId:d,context:{...l,account:m},digests:h,typedData:y}}async function st(e,t){const{account:n=e.account,chain:r=e.chain,webAuthn:s}=t;if(!r)throw new Error("`chain` is required.");const o=n?B(n):void 0;if(!o)throw new Error("`account` is required.");const i=t.key??Pt(o,t);if(!i&&!o.sign)throw new Error("`key` or `account` with `sign` is required");const u=await Promise.all((t.preCalls??[]).map(async d=>{if(d.signature)return d;const{authorizeKeys:l,key:h,calls:y,revokeKeys:m}=d,{context:g,digest:b}=await Se(e,{account:o,authorizeKeys:l,calls:y,chain:r,feeToken:t.feeToken,key:h,preCalls:!0,revokeKeys:m}),w=await le(h,{address:null,payload:b,webAuthn:s});return{context:g,signature:w}})),{capabilities:c,context:a,digest:f}=await Se(e,{...t,account:o,chain:r,key:i,preCalls:u}),p=await(async()=>i?await le(i,{address:null,payload:f,webAuthn:s,wrap:!1}):await o.sign({hash:f}))();return await ct(e,{capabilities:c.feeSignature?{feeSignature:c.feeSignature}:void 0,context:a,key:i,signature:p})}async function ct(e,t){const{capabilities:n,context:r,key:s,signature:o}=t;return await Li(e,{capabilities:n,context:r,key:s?It(s):void 0,signature:o})}async function $n(e,t){const{email:n,walletAddress:r}=t;return await $i(e,{email:n,walletAddress:r})}async function Jt(e,t){if(t.account){const{account:o}=t,i=[...o.keys??[],...t.authorizeKeys??[]].filter((f,p,d)=>d.findIndex(l=>l.id===f.id)===p),{digests:u,...c}=await Rr(e,{...t,address:o.address,authorizeKeys:i}),a={auth:await o.sign({hash:u.auth}),exec:await o.sign({hash:u.exec})};return await Jt(e,{...c,signatures:a})}const{context:n,signatures:r}=t,s=B(n.account);return await Ki(e,{context:n,signatures:r}),s}async function Ji(e,t){const{chainId:n,email:r,signature:s,token:o,walletAddress:i}=t;return await Fi(e,{chainId:n,email:r,signature:s,token:o,walletAddress:i})}async function ze(e,t){const{address:n}=t,{authorization:r,data:s,to:o}=await Ni(e,{address:n});return is({authorization:{...r,nonce:BigInt(r.nonce),r:BigInt(r.r),s:BigInt(r.s)},data:s,signature:t.signature,to:o})}function Kn(e,t){const{tokens:n}=t,r=n.filter(s=>s.interop);return e.map(s=>{if(s.address)return s;const o=r.find(i=>i.symbol===s.symbol);if(!o)throw new Error(`interop token not found: ${s.symbol}`);return{address:o.address,value:mr(s.value,o.decimals)}})}async function ne(e,t){const{chain:n=e.chain}=t??{};return await Ge(e,{chainId:n?.id}).then(s=>s.fees.tokens)}async function Xt(e,t){const{addressOrSymbol:n}=t;return(await ne(e,t)).find(Xt.predicate(n))}(function(e){function t(n){return r=>n?Mt(n)?N(r.address,n):n==="native"?r.address===_e:n===r.symbol:!1}e.predicate=t})(Xt||(Xt={}));async function ge(e,t){const{chain:n=e.chain,store:r}=t??{},s=r?.getState()??{},o=t?.addressOrSymbol??s.feeToken;return(await ne(e,{chain:n}).then(c=>c.filter(a=>a.feeToken)))?.find(c=>o?o==="native"&&c.address===_e||Mt(o)&&N(c.address,o)?!0:o===c.symbol:!1)}function Lr(e={}){const t=e,{mock:n,multichain:r=!0,webAuthn:s}=t;let o,i;const u=(()=>{if(t.keystoreHost!=="self"&&!(typeof window<"u"&&window.location?.hostname==="localhost"))return t.keystoreHost})();return Ur({actions:{async addFunds(){throw new Qe},async createAccount(c){const{admins:a,email:f,label:p,permissions:d,internal:l,signInWithEthereum:h}=c,{client:y}=l,m=zi(cs()),g=await ne(y),b=n?On():await Cn({createFn:s?.createFn,label:p||`${m.address.slice(0,8)}${m.address.slice(-6)}`,rpId:u,userId:Rt(m.address)}),w=await oe(d,{chainId:y.chain.id,feeTokens:g}),I=a?.map(v=>G(v)),M=await Jt(y,{account:m,authorizeKeys:[b,...I??[],...w?[w]:[]]});o=m.address,f&&p&&await $n(y,{email:p,walletAddress:M.address});const x=await(async()=>{if(!h)return;const v=await _t(y,h,{address:M.address}),j=await Te(m,{payload:tt(X(v))}),E=await ze(y,{address:M.address,signature:j});return{message:v,signature:E}})();return{account:{...M,signInWithEthereum:x}}},async getAccountVersion(c){const{address:a,internal:f}=c,{client:p}=f,{contracts:d}=await Ge(p),{accountImplementation:l}=d,h=await Rn(p,{account:B(l)}).then(m=>m.version),y=await Rn(p,{account:a}).then(m=>m.version).catch(()=>h);if(!y||!h)throw new Error("version not found.");return{current:y,latest:h}},async getAssets(c){const{account:a,chainFilter:f,assetFilter:p,assetTypeFilter:d,internal:l}=c,{client:h}=l;return await Si(h,{account:a,assetFilter:p,assetTypeFilter:d,chainFilter:f})},async getCallsStatus(c){const{id:a,internal:f}=c,{client:p}=f,d=await _i(p,{id:a});return{atomic:!0,chainId:q(p.chain.id),id:a,receipts:d.receipts?.map(l=>({blockHash:l.blockHash,blockNumber:q(l.blockNumber),gasUsed:q(l.gasUsed),logs:l.logs,status:l.status,transactionHash:l.transactionHash})),status:d.status,version:"1.0"}},async getCapabilities(c){const{chainIds:a,internal:f}=c,{client:p}=f,d={atomic:{status:"supported"},atomicBatch:{supported:!0},feeToken:{supported:!0,tokens:[]},merchant:{supported:!0},permissions:{supported:!0},requiredFunds:{supported:!!r,tokens:[]}},l=await Ge(p,{chainIds:a?a.map(h=>Ne(h)):"all",raw:!0});return Object.entries(l).reduce((h,[y,m])=>({...h,[y]:{...d,...m,feeToken:{supported:!0,tokens:m.fees.tokens},requiredFunds:{supported:!!r,tokens:r?m.fees.tokens.filter(g=>g.interop):[]}}}),{})},async getKeys(c){const{account:a,chainIds:f,internal:p}=c,{client:d}=p,l=await Ln(d,{account:a,chainIds:f});return kr([...l,...a.keys??[]],h=>h.publicKey)},async grantAdmin(c){const{account:a,internal:f}=c,{client:p}=f,d=G(c.key,{chainId:p.chain.id}),l=await ge(p,{addressOrSymbol:c.feeToken,store:f.store}),{id:h}=await st(p,{account:a,authorizeKeys:[d],feeToken:l?.address,webAuthn:s});return await Ce(p,{id:h,pollingInterval:500}),{key:d}},async grantPermissions(c){const{account:a,internal:f,permissions:p}=c,{client:d}=f,l=await ne(d),h=await oe(p,{chainId:d.chain.id,feeTokens:l});if(!h)throw new Error("key to authorize not found.");const y=a.keys?.find(w=>w.role==="admin"&&w.privateKey);if(!y)throw new Error("admin key not found.");const{context:m,digest:g}=await Se(d,{account:a,authorizeKeys:[h],key:y,preCalls:!0}),b=await le(y,{address:null,payload:g});return await ct(d,{context:m,key:y,signature:b}),{key:h}},async loadAccounts(c){const{internal:a,permissions:f,signInWithEthereum:p}=c,{client:d}=a,l=await ne(d),h=await oe(f,{chainId:d.chain.id,feeTokens:l}),{digest:y,digestType:m,message:g}=await(async()=>{if(p&&c.address){const k=await _t(d,p,{address:c.address});return{context:void 0,digest:tt(X(k)),digestType:"siwe",message:k}}return{context:void 0,digest:"0x",message:void 0}})(),{address:b,credentialId:w,webAuthnSignature:I}=await(async()=>{if(n){if(!o)throw new Error("address_internal not found.");return{address:o,credentialId:void 0}}if(c.address&&c.key)return{address:c.address,credentialId:c.key.credentialId};const k=await xr({challenge:y,getFn:s?.getFn,rpId:u}),C=k.raw.response,D=rn(new Uint8Array(C.userHandle)),T=k.raw.id;return{address:D,credentialId:T,webAuthnSignature:k}})(),M=await Ln(d,{account:b,chainIds:[d.chain.id]}),x=B({address:b,keys:[...M,...h?[h]:[]].map((k,C)=>C===0&&k.type==="webauthn-p256"?zr({...k,credential:{id:w,publicKey:Wn(k.publicKey)},id:b,rpId:u}):k)}),v=Pt(x,{role:"admin"}),j=await(async()=>{if(y!=="0x")return I?Sr(Wt(I),{keyType:"webauthn-p256",publicKey:v.publicKey}):await le(v,{address:x.address,payload:y})})();if(h){const{context:k,digest:C}=await Se(d,{account:x,authorizeKeys:[h],preCalls:!0}),D=await le(v,{address:null,payload:C});await ct(d,{context:k,key:v,signature:D})}const E=await(async()=>{if(p){if(m==="siwe"&&g&&j){const k=await ze(d,{address:x.address,signature:j});return{message:g,signature:k}}{const k=await _t(d,p,{address:x.address}),C=await Te(x,{payload:tt(X(k)),role:"admin"}),D=await ze(d,{address:x.address,signature:C});return{message:k,signature:D}}}})();return{accounts:[{...x,signInWithEthereum:E}]}},async prepareCalls(c){const{account:a,calls:f,internal:p,merchantUrl:d}=c,{client:l}=p,h=c.key??await Zt({account:a,calls:f});if(!h)throw new Error("cannot find authorized key to sign with.");const[y,m]=await Promise.all([ne(l),ge(l,{addressOrSymbol:c.feeToken,store:p.store})]),g=Kn(c.requiredFunds??[],{tokens:y}),{capabilities:b,context:w,digest:I,typedData:M}=await Se(l,{account:a,calls:f,feeToken:m?.address,key:h,merchantUrl:d,requiredFunds:r?g:void 0}),x=w.quote?.quotes??[],v=x[x.length-1];return{account:a,capabilities:{...b,quote:w.quote},chainId:l.chain.id,context:{...w,account:a,calls:f,nonce:v?.intent.nonce},digest:I,key:h,typedData:M}},async prepareUpgradeAccount(c){const{address:a,email:f,label:p,internal:d,permissions:l}=c,{client:h}=d,[y,m]=await Promise.all([ne(h),ge(h,{store:d.store})]),g=n?On():await Cn({createFn:s?.createFn,label:p||`${a.slice(0,8)}${a.slice(-6)}`,rpId:u,userId:Rt(a)}),b=await oe(l,{chainId:h.chain.id,feeTokens:y}),{context:w,digests:I}=await Rr(h,{address:a,authorizeKeys:[g,...b?[b]:[]],feeToken:m?.address});return f&&(i=p),{context:w,digests:I}},async revokeAdmin(c){const{account:a,id:f,internal:p}=c,{client:d}=p,l=a.keys?.find(h=>h.id===f);if(l){if(l.type==="webauthn-p256"&&a.keys?.filter(h=>h.type==="webauthn-p256").length===1)throw new Error("revoke the only WebAuthn key left.");try{const h=await ge(d,{addressOrSymbol:c.feeToken,store:p.store}),{id:y}=await st(d,{account:a,feeToken:h?.address,revokeKeys:[l],webAuthn:s});await Ce(d,{id:y})}catch(h){const y=h;if(y.name==="Rpc.ExecutionError"&&y.abiError?.name==="KeyDoesNotExist")return;throw h}}},async revokePermissions(c){const{account:a,id:f,internal:p}=c,{client:d}=p,l=a.keys?.find(h=>h.id===f);if(l){if(l.role==="admin")throw new Error("cannot revoke admins.");try{const h=await ge(d,{addressOrSymbol:c.feeToken,store:p.store}),{id:y}=await st(d,{account:a,feeToken:h?.address,revokeKeys:[l],webAuthn:s});await Ce(d,{id:y})}catch(h){const y=h;if(y.name==="Rpc.ExecutionError"&&y.abiError?.name==="KeyDoesNotExist")return;throw h}}},async sendCalls(c){const{account:a,asTxHash:f,calls:p,internal:d,merchantUrl:l}=c,{client:h}=d,y=await Zt({account:a,calls:p,permissionsId:c.permissionsId}),[m,g]=await Promise.all([ne(h),ge(h,{addressOrSymbol:c.feeToken,store:d.store})]),b=Kn(c.requiredFunds??[],{tokens:m}),w=await st(h,{account:a,calls:p,feeToken:g?.address,key:y,merchantUrl:l,requiredFunds:r?b:void 0,webAuthn:s});if(f){const{id:I,receipts:M,status:x}=await Ce(h,{id:w.id,pollingInterval:500});if(!M?.[0])throw x==="success"?new We({message:"Call bundle with id: "+I+" not found."}):new fe({message:"Transaction failed under call bundle id: "+I+"."});return{id:M[0].transactionHash}}return w},async sendPreparedCalls(c){const{context:a,key:f,internal:p,signature:d}=c,{client:l}=p,{id:h}=await ct(l,{context:a,key:f,signature:d});return h},async signPersonalMessage(c){const{account:a,data:f,internal:p}=c,{client:d}=p,l=a.keys?.find(y=>y.role==="admin"&&y.privateKey);if(!l)throw new Error("cannot find admin key to sign with.");const h=await Te(a,{key:l,payload:tt(f),webAuthn:s});return ze(d,{address:a.address,signature:h})},async signTypedData(c){const{account:a,internal:f}=c,{client:p}=f,d=a.keys?.find(m=>m.role==="admin"&&m.privateKey);if(!d)throw new Error("cannot find admin key to sign with.");const l=ha(c.data),h=l.domain?.name==="Orchestrator",y=await Te(a,{key:d,payload:ln(l),replaySafe:!h,webAuthn:s});return h?y:ze(p,{address:a.address,signature:y})},async upgradeAccount(c){const{account:a,context:f,internal:p,signatures:d}=c,{client:l}=p;return await Jt(l,{context:f,signatures:d}),i&&await $n(l,{email:i,walletAddress:a.address}),{account:a}},async verifyEmail(c){const{account:a,chainId:f,email:p,token:d,internal:l,walletAddress:h}=c,{client:y}=l,m=a.keys?.find(b=>b.role==="admin"&&b.privateKey);if(!m)throw new Error("cannot find admin key to sign with.");const g=await Te(a,{key:m,payload:F(X(`${p}${d}`)),webAuthn:s});return await Ji(y,{chainId:f,email:p,signature:g,token:d,walletAddress:h})}},config:e,name:"rpc"})}function Xi(e={}){const{fallback:t=Lr(),host:n=jr.prod,renderer:r=mi(),theme:s,themeController:o}=e,i=new Set,u=Ao();function c(a){return hr({async request(f){const p=u.prepare(f);return a.setState(d=>{const l=d.accounts[0],h=l?.keys?.find(y=>y.role==="admin"&&y.type==="webauthn-p256");return{...d,requestQueue:[...d.requestQueue,{account:l?{address:l.address,key:h?{credentialId:h?.credentialId,publicKey:h.publicKey}:void 0}:void 0,request:p,status:"pending"}]}}),new Promise((d,l)=>{const h=y=>{const m=y.find(g=>g.request.id===p.id);if(!m&&y.length===0){i.delete(h),l(new Ie);return}m&&(m.status!=="success"&&m.status!=="error"||(i.delete(h),m.status==="success"?d(m.result):l(yr(m.error)),a.setState(g=>({...g,requestQueue:g.requestQueue.filter(b=>b.request.id!==p.id)}))))};i.add(h)})}},{})}return Ur({actions:{async addFunds(a){const{internal:f}=a,{request:p,store:d}=f;if(p.method!=="wallet_addFunds")throw new Error("Cannot add funds for method: "+p.method);return await c(d).request(p)},async createAccount(a){const{internal:f}=a,{client:p,config:d,request:l,store:h}=f,{storage:y}=d,m=c(h);return{account:await(async()=>{if(l.method==="wallet_connect"){const[{capabilities:b,chainIds:w}]=l._decoded.params??[{}],I=qt(b?.signInWithEthereum?.authUrl??d.authUrl,{storage:y}),M=l.params?.[0]?.capabilities?.signInWithEthereum,x=await oe(b?.grantPermissions,{chainId:p.chain.id}),v=x?O(nt,rt(x)):void 0,{accounts:j}=await m.request({...l,params:[{capabilities:{...l.params?.[0]?.capabilities,grantPermissions:v,signInWithEthereum:I||M?{...M,authUrl:I}:void 0},chainIds:w?.map(T=>q(T))}]}),[E]=j;if(!E)throw new Error("no account found.");const k=E.capabilities?.admins?.map(T=>G(T,{chainId:p.chain.id})).filter(Boolean),C=E.capabilities?.permissions?.map(T=>{try{const A=Nn(R(Vt,T));return A.id===x?.id?{...A,...x,permissions:A.permissions}:A}catch{return}}).filter(Boolean),D=await(async()=>{if(!E.capabilities?.signInWithEthereum)return;const{message:T,signature:A}=E.capabilities.signInWithEthereum;if(!I)return{message:T,signature:A};const{token:z}=await qn({address:E.address,authUrl:I,message:T,signature:A});return{message:T,signature:A,token:z}})();return{...B({address:E.address,keys:[...k,...C]}),signInWithEthereum:D}}throw new Error(`Account creation not supported on method: ${l.method}`)})()}},async disconnect(a){const{internal:f}=a,{config:p}=f,{storage:d}=p,l=await d.getItem("porto.authUrl")||void 0,h=qt(p.authUrl??l,{storage:d});h&&await fetch(h.logout,{credentials:"include",method:"POST"}).catch(()=>{})},async getAccountVersion(a){const{internal:f}=a,{store:p,request:d}=f;if(d.method!=="wallet_getAccountVersion")throw new Error("Cannot get version for method: "+d.method);return r.supportsHeadless?await c(p).request(d):t.actions.getAccountVersion(a)},async getAssets(a){const{internal:f}=a,{store:p,request:d}=f;if(d.method!=="wallet_getAssets")throw new Error("Cannot get assets for method: "+d.method);if(!r.supportsHeadless)return t.actions.getAssets(a);const h=await c(p).request(d);return R(cn.Response,h)},async getCallsStatus(a){const{internal:f}=a,{store:p,request:d}=f;if(d.method!=="wallet_getCallsStatus")throw new Error("Cannot get status for method: "+d.method);return r.supportsHeadless?await c(p).request(d):t.actions.getCallsStatus(a)},async getCapabilities(a){const{internal:f}=a,{store:p,request:d}=f;if(d.method!=="wallet_getCapabilities")throw new Error("Cannot get capabilities for method: "+d.method);return r.supportsHeadless?await c(p).request(d):t.actions.getCapabilities(a)},async getKeys(a){const{account:f,chainIds:p,internal:d}=a,{store:l}=d,h=await(async()=>{if(!r.supportsHeadless)return t.actions.getKeys(a);const m=await c(l).request({method:"wallet_getKeys",params:[O(ft.Parameters,{address:f.address,chainIds:p})]});return R(ft.Response,m)})();return kr([...h,...f.keys??[]],y=>y.publicKey)},async grantAdmin(a){const{internal:f}=a,{request:p,store:d}=f;if(p.method!=="wallet_grantAdmin")throw new Error("Cannot authorize admin for method: "+p.method);const[l]=p._decoded.params,h=G(l.key);if(!h)throw new Error("no key found.");const y=await at(f,a);return await c(d).request({method:"wallet_grantAdmin",params:[{...p.params?.[0],capabilities:{...p.params?.[0]?.capabilities,feeToken:y}}]}),{key:h}},async grantPermissions(a){const{internal:f}=a,{client:p,request:d,store:l}=f;if(d.method!=="wallet_grantPermissions")throw new Error("Cannot grant permissions for method: "+d.method);const[{address:h,...y}]=d._decoded.params,m=await oe(y,{chainId:p.chain.id});if(!m)throw new Error("no key found.");const g=O(nt,rt(m));return await c(l).request({method:"wallet_grantPermissions",params:[g]}),{key:m}},async loadAccounts(a){const{internal:f}=a,{client:p,config:d,store:l}=f,{storage:h}=d,y=c(l),m=f.request;if(m.method!=="wallet_connect"&&m.method!=="eth_requestAccounts")throw new Error("Cannot load accounts for method: "+m.method);return{accounts:await(async()=>{const[b]=m._decoded.params??[],{capabilities:w}=b??{},I=qt(w?.signInWithEthereum?.authUrl??d.authUrl,{storage:h}),M=m.params?.[0]?.capabilities?.signInWithEthereum,x=await oe(w?.grantPermissions,{chainId:p.chain.id}),v=x?O(nt,rt(x)):void 0,{accounts:j}=await y.request({method:"wallet_connect",params:[{...m.params?.[0],capabilities:{...m.params?.[0]?.capabilities,grantPermissions:v,signInWithEthereum:I||M?{...M,authUrl:I}:void 0}}]});return Promise.all(j.map(async E=>{const k=E.capabilities?.admins?.map(T=>G(T)).filter(Boolean),C=E.capabilities?.permissions?.map(T=>{try{const A=Nn(R(Vt,T));return A.id===x?.id?{...A,...x,permissions:A.permissions}:A}catch{return}}).filter(Boolean),D=await(async()=>{if(!E.capabilities?.signInWithEthereum)return;const{message:T,signature:A}=E.capabilities.signInWithEthereum;if(!I)return{message:T,signature:A};const{token:z}=await qn({address:E.address,authUrl:I,message:T,signature:A});return{message:T,signature:A,token:z}})();return{...B({address:E.address,keys:[...k,...C]}),signInWithEthereum:D}}))})()}},async prepareCalls(a){const{account:f,internal:p}=a,{store:d,request:l}=p;if(l.method!=="wallet_prepareCalls")throw new Error("Cannot prepare calls for method: "+l.method);if(!r.supportsHeadless)return t.actions.prepareCalls(a);const h=await at(p,a),y=c(d),m=R(pt.Response,await y.request({...l,params:[{...l.params?.[0],capabilities:{...l.params?.[0]?.capabilities,feeToken:h}}]}));return{account:f,chainId:Number(m.chainId),context:m.context,digest:m.digest,key:m.key,typedData:m.typedData}},async prepareUpgradeAccount(a){const{internal:f}=a,{client:p,store:d,request:l}=f;if(l.method!=="wallet_prepareUpgradeAccount")throw new Error("Cannot prepare upgrade for method: "+l.method);if(!r.supportsHeadless)return t.actions.prepareUpgradeAccount(a);const[{capabilities:h}]=l._decoded.params??[{}],y=await oe(h?.grantPermissions,{chainId:p.chain.id}),m=y?O(nt,rt(y)):void 0,g=c(d),{context:b,digests:w}=await g.request({...l,params:[{...l.params?.[0],capabilities:{...l.params?.[0]?.capabilities,grantPermissions:m}}]}),I=b.account.keys?.map(M=>M.id===y?.id?{...M,...y}:M);return{context:{...b,account:{...b.account,keys:I}},digests:w}},async revokeAdmin(a){const{account:f,id:p,internal:d}=a,{store:l,request:h}=d;if(h.method!=="wallet_revokeAdmin")throw new Error("Cannot revoke admin for method: "+h.method);const y=f.keys?.find(b=>b.id===p);if(!y)return;if(y.type==="webauthn-p256"&&f.keys?.filter(b=>b.type==="webauthn-p256").length===1)throw new Error("revoke the only WebAuthn key left.");const m=await at(d,a);return await c(l).request({...h,params:[{...h.params?.[0],capabilities:{...h.params?.[0]?.capabilities,feeToken:m}}]})},async revokePermissions(a){const{account:f,id:p,internal:d}=a,{store:l,request:h}=d;if(h.method!=="wallet_revokePermissions")throw new Error("Cannot revoke permissions for method: "+h.method);const y=f.keys?.find(g=>g.id===p);if(!y)return;if(y.role==="admin")throw new Error("cannot revoke permissions.");return await c(l).request(h)},async sendCalls(a){const{account:f,asTxHash:p,calls:d,internal:l,merchantUrl:h,requiredFunds:y}=a,{client:m,store:g,request:b}=l,w=c(g),I=await at(l,a),M=await Zt({account:f,calls:d,permissionsId:a.permissionsId});if(M&&M.role==="session"){if(!r.supportsHeadless)return t.actions.sendCalls(a);try{const x=await w.request(O(pt.Request,{method:"wallet_prepareCalls",params:[{calls:d,capabilities:{...b._decoded.method==="wallet_sendCalls"?b._decoded.params?.[0]?.capabilities:void 0,feeToken:I,merchantUrl:h,requiredFunds:y},chainId:m.chain.id,from:f.address,key:M}]})),v=x.capabilities?.quote?.quotes??[];if(v.some((D,T)=>T===v.length-1&&v.length>1?!1:an(D.feeTokenDeficit)>0n))throw new Error("insufficient funds");const E=await le(M,{address:null,payload:x.digest,wrap:!1}),C=(await w.request({method:"wallet_sendPreparedCalls",params:[{...x,signature:E}]}))[0];if(!C)throw new Error("id not found");if(p){const{id:D,receipts:T,status:A}=await Ce(m,{id:C.id,pollingInterval:500});if(!T?.[0])throw A==="success"?new We({message:"Call bundle with id: "+D+" not found."}):new fe({message:"Transaction failed under call bundle id: "+D+"."});return{id:T[0].transactionHash}}return C}catch{}}if(b.method==="eth_sendTransaction")return{id:await w.request({...b,params:[{...b.params?.[0],capabilities:{feeToken:I,merchantUrl:h}}]})};if(b.method==="wallet_sendCalls")return await w.request({method:"wallet_sendCalls",params:[{...b.params?.[0],capabilities:{...b.params?.[0]?.capabilities,feeToken:I,merchantUrl:h}}]});throw new Error("Cannot execute for method: "+b.method)},async sendPreparedCalls(a){const{internal:f}=a,{store:p,request:d}=f;if(d.method!=="wallet_sendPreparedCalls")throw new Error("Cannot send prepared calls for method: "+d.method);if(!r.supportsHeadless)return t.actions.sendPreparedCalls(a);const y=(await c(p).request(d))[0]?.id;if(!y)throw new Error("id not found");return y},async signPersonalMessage(a){const{internal:f}=a,{store:p,request:d}=f;if(d.method!=="personal_sign")throw new Error("Cannot sign personal message for method: "+d.method);return await c(p).request(d)},async signTypedData(a){const{internal:f}=a,{store:p,request:d}=f;if(d.method!=="eth_signTypedData_v4")throw new Error("Cannot sign typed data for method: "+d.method);return await c(p).request(d)},async switchChain(a){const{internal:f}=a,{store:p,request:d}=f;if(d.method!=="wallet_switchEthereumChain")throw new Error("Cannot switch chain for method: "+d.method);return r.supportsHeadless?await c(p).request(d):void 0},async upgradeAccount(a){const{account:f,internal:p}=a,{store:d,request:l}=p;if(l.method!=="wallet_upgradeAccount")throw new Error("Cannot upgrade account for method: "+l.method);return await c(d).request(l),{account:f}},async verifyEmail(a){const{internal:f}=a,{request:p,store:d}=f;if(p.method!=="account_verifyEmail")throw new Error("Cannot verify email for method: "+p.method);return await c(d).request(p)}},config:e,name:"dialog",setup(a){const{internal:f}=a,{store:p}=f,d=r.setup({host:n,internal:f,theme:s,themeController:o}),l=p.subscribe(h=>h.requestQueue,h=>{for(const m of i)m(h);const y=h.map(m=>m.status==="pending"?m:void 0).filter(Boolean);d.syncRequests(y).catch(()=>{}),y.length===0&&d.close()});return()=>{l(),d.destroy()}}})}async function at(e,t){const{config:{feeToken:n}}=e,{feeToken:r}=t??{};return r??n}function qt(e,{storage:t}){if(!e)return;const n=qr(e,typeof window<"u"?window.location.origin:void 0);return n&&t.setItem("porto.authUrl",n),n}function ec(){const e=typeof indexedDB<"u"?Ma("porto","store"):void 0;return{async getItem(t){const n=await ka(t,e);return n===null?null:n},async removeItem(t){await va(t,e)},async setItem(t,n){await xa(t,Me(n),e)},sizeLimit:1024*1024*50}}function tc(){const e=new Map;return{getItem(t){return e.get(t)??null},removeItem(t){e.delete(t)},setItem(t,n){e.set(t,n)},sizeLimit:Number.POSITIVE_INFINITY}}const Fn=typeof window<"u"&&typeof document<"u",ue={announceProvider:!0,chains:ui,mode:Fn?Xi({host:jr.prod}):Lr(),relay:At(Qi.prod.http),storage:Fn&&typeof indexedDB<"u"?ec():tc(),storageKey:"porto.store"};function nc(e={}){const t=e.chains??ue.chains,n=Object.fromEntries(t.map(a=>[a.id,e.transports?.[a.id]??At()])),r={announceProvider:e.announceProvider??ue.announceProvider,authUrl:e.authUrl,chains:t,feeToken:e.feeToken,merchantUrl:e.merchantUrl,mode:e.mode??ue.mode,relay:e.relay??ue.relay,storage:e.storage??ue.storage,storageKey:e.storageKey??ue.storageKey,transports:n},s=ya(ma(ga(ba(a=>({accounts:[],chainIds:r.chains.map(f=>f.id),feeToken:r.feeToken,requestQueue:[]}),{merge(a,f){const p=a,d=r.chains.find(h=>h.id===p.chainIds[0])?.id??r.chains[0].id,l=[d,...r.chains.map(h=>h.id).filter(h=>h!==d)];return{...f,...p,chainIds:l}},name:r.storageKey,partialize:a=>({accounts:a.accounts.map(f=>Me(f)),chainIds:a.chainIds}),storage:r.storage,version:5}))));let o=r.mode;const i={config:r,getMode(){return o},id:fn(),setMode(a){return c?.(),o=a,c=a.setup({internal:i}),c},store:s},u=Vi(i);let c=o!==null?o.setup({internal:i}):()=>{};return{_internal:i,config:r,destroy(){c(),u._internal.destroy()},provider:u}}const cc=Object.freeze(Object.defineProperty({__proto__:null,create:nc,defaultConfig:ue},Symbol.toStringTag,{value:"Module"}));export{cc as Porto,Vi as from};
